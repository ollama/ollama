// AUTO-GENERATED by generate_wrappers.py - DO NOT EDIT
// This file contains the function pointer definitions and initialization
// All function pointers are in a single compilation unit to avoid duplication

#include "mlx/c/mlx.h"
#include "mlx_dynamic.h"
#include <stdio.h>
#include <dlfcn.h>

// Function pointer definitions
mlx_fast_cuda_kernel_config (*w_mlx_fast_cuda_kernel_config_new_ptr)(void) = NULL;
void (*w_mlx_fast_cuda_kernel_config_free_ptr)(mlx_fast_cuda_kernel_config cls) = NULL;
int (*w_mlx_fast_cuda_kernel_config_add_output_arg_ptr)(mlx_fast_cuda_kernel_config cls, const int* shape, size_t size, mlx_dtype dtype) = NULL;
int (*w_mlx_fast_cuda_kernel_config_set_grid_ptr)(mlx_fast_cuda_kernel_config cls, int grid1, int grid2, int grid3) = NULL;
int (*w_mlx_fast_cuda_kernel_config_set_thread_group_ptr)(mlx_fast_cuda_kernel_config cls, int thread1, int thread2, int thread3) = NULL;
int (*w_mlx_fast_cuda_kernel_config_set_init_value_ptr)(mlx_fast_cuda_kernel_config cls, float value) = NULL;
int (*w_mlx_fast_cuda_kernel_config_set_verbose_ptr)(mlx_fast_cuda_kernel_config cls, bool verbose) = NULL;
int (*w_mlx_fast_cuda_kernel_config_add_template_arg_dtype_ptr)(mlx_fast_cuda_kernel_config cls, const char* name, mlx_dtype dtype) = NULL;
int (*w_mlx_fast_cuda_kernel_config_add_template_arg_int_ptr)(mlx_fast_cuda_kernel_config cls, const char* name, int value) = NULL;
int (*w_mlx_fast_cuda_kernel_config_add_template_arg_bool_ptr)(mlx_fast_cuda_kernel_config cls, const char* name, bool value) = NULL;
mlx_fast_cuda_kernel (*w_mlx_fast_cuda_kernel_new_ptr)(const char* name, const mlx_vector_string input_names, const mlx_vector_string output_names, const char* source, const char* header, bool ensure_row_contiguous, int shared_memory) = NULL;
void (*w_mlx_fast_cuda_kernel_free_ptr)(mlx_fast_cuda_kernel cls) = NULL;
int (*w_mlx_fast_cuda_kernel_apply_ptr)(mlx_vector_array* outputs, mlx_fast_cuda_kernel cls, const mlx_vector_array inputs, const mlx_fast_cuda_kernel_config config, const mlx_stream stream) = NULL;
int (*w_mlx_fast_layer_norm_ptr)(mlx_array* res, const mlx_array x, const mlx_array weight , const mlx_array bias , float eps, const mlx_stream s) = NULL;
mlx_fast_metal_kernel_config (*w_mlx_fast_metal_kernel_config_new_ptr)(void) = NULL;
void (*w_mlx_fast_metal_kernel_config_free_ptr)(mlx_fast_metal_kernel_config cls) = NULL;
int (*w_mlx_fast_metal_kernel_config_add_output_arg_ptr)(mlx_fast_metal_kernel_config cls, const int* shape, size_t size, mlx_dtype dtype) = NULL;
int (*w_mlx_fast_metal_kernel_config_set_grid_ptr)(mlx_fast_metal_kernel_config cls, int grid1, int grid2, int grid3) = NULL;
int (*w_mlx_fast_metal_kernel_config_set_thread_group_ptr)(mlx_fast_metal_kernel_config cls, int thread1, int thread2, int thread3) = NULL;
int (*w_mlx_fast_metal_kernel_config_set_init_value_ptr)(mlx_fast_metal_kernel_config cls, float value) = NULL;
int (*w_mlx_fast_metal_kernel_config_set_verbose_ptr)(mlx_fast_metal_kernel_config cls, bool verbose) = NULL;
int (*w_mlx_fast_metal_kernel_config_add_template_arg_dtype_ptr)(mlx_fast_metal_kernel_config cls, const char* name, mlx_dtype dtype) = NULL;
int (*w_mlx_fast_metal_kernel_config_add_template_arg_int_ptr)(mlx_fast_metal_kernel_config cls, const char* name, int value) = NULL;
int (*w_mlx_fast_metal_kernel_config_add_template_arg_bool_ptr)(mlx_fast_metal_kernel_config cls, const char* name, bool value) = NULL;
mlx_fast_metal_kernel (*w_mlx_fast_metal_kernel_new_ptr)(const char* name, const mlx_vector_string input_names, const mlx_vector_string output_names, const char* source, const char* header, bool ensure_row_contiguous, bool atomic_outputs) = NULL;
void (*w_mlx_fast_metal_kernel_free_ptr)(mlx_fast_metal_kernel cls) = NULL;
int (*w_mlx_fast_metal_kernel_apply_ptr)(mlx_vector_array* outputs, mlx_fast_metal_kernel cls, const mlx_vector_array inputs, const mlx_fast_metal_kernel_config config, const mlx_stream stream) = NULL;
int (*w_mlx_fast_rms_norm_ptr)(mlx_array* res, const mlx_array x, const mlx_array weight , float eps, const mlx_stream s) = NULL;
int (*w_mlx_fast_rope_ptr)(mlx_array* res, const mlx_array x, int dims, bool traditional, mlx_optional_float base, float scale, int offset, const mlx_array freqs , const mlx_stream s) = NULL;
int (*w_mlx_fast_rope_dynamic_ptr)(mlx_array* res, const mlx_array x, int dims, bool traditional, mlx_optional_float base, float scale, const mlx_array offset, const mlx_array freqs , const mlx_stream s) = NULL;
int (*w_mlx_fast_scaled_dot_product_attention_ptr)(mlx_array* res, const mlx_array queries, const mlx_array keys, const mlx_array values, float scale, const char* mask_mode, const mlx_array mask_arr , const mlx_array sinks , const mlx_stream s) = NULL;
void (*w_mlx_set_error_handler_ptr)(mlx_error_handler_func handler, void* data, void (*dtor)(void*)) = NULL;
void (*w__mlx_error_ptr)(const char* file, const int line, const char* fmt, ...) = NULL;
int (*w_mlx_fft_fft_ptr)(mlx_array* res, const mlx_array a, int n, int axis, const mlx_stream s) = NULL;
int (*w_mlx_fft_fft2_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_fftn_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_fftshift_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_ifft_ptr)(mlx_array* res, const mlx_array a, int n, int axis, const mlx_stream s) = NULL;
int (*w_mlx_fft_ifft2_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_ifftn_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_ifftshift_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_irfft_ptr)(mlx_array* res, const mlx_array a, int n, int axis, const mlx_stream s) = NULL;
int (*w_mlx_fft_irfft2_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_irfftn_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_rfft_ptr)(mlx_array* res, const mlx_array a, int n, int axis, const mlx_stream s) = NULL;
int (*w_mlx_fft_rfft2_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_fft_rfftn_ptr)(mlx_array* res, const mlx_array a, const int* n, size_t n_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_version_ptr)(mlx_string* str_) = NULL;
int (*w_mlx_export_function_ptr)(const char* file, const mlx_closure fun, const mlx_vector_array args, bool shapeless) = NULL;
int (*w_mlx_export_function_kwargs_ptr)(const char* file, const mlx_closure_kwargs fun, const mlx_vector_array args, const mlx_map_string_to_array kwargs, bool shapeless) = NULL;
mlx_function_exporter (*w_mlx_function_exporter_new_ptr)(const char* file, const mlx_closure fun, bool shapeless) = NULL;
int (*w_mlx_function_exporter_free_ptr)(mlx_function_exporter xfunc) = NULL;
int (*w_mlx_function_exporter_apply_ptr)(const mlx_function_exporter xfunc, const mlx_vector_array args) = NULL;
int (*w_mlx_function_exporter_apply_kwargs_ptr)(const mlx_function_exporter xfunc, const mlx_vector_array args, const mlx_map_string_to_array kwargs) = NULL;
mlx_imported_function (*w_mlx_imported_function_new_ptr)(const char* file) = NULL;
int (*w_mlx_imported_function_free_ptr)(mlx_imported_function xfunc) = NULL;
int (*w_mlx_imported_function_apply_ptr)(mlx_vector_array* res, const mlx_imported_function xfunc, const mlx_vector_array args) = NULL;
int (*w_mlx_imported_function_apply_kwargs_ptr)(mlx_vector_array* res, const mlx_imported_function xfunc, const mlx_vector_array args, const mlx_map_string_to_array kwargs) = NULL;
mlx_device (*w_mlx_device_new_ptr)(void) = NULL;
mlx_device (*w_mlx_device_new_type_ptr)(mlx_device_type type, int index) = NULL;
int (*w_mlx_device_free_ptr)(mlx_device dev) = NULL;
int (*w_mlx_device_set_ptr)(mlx_device* dev, const mlx_device src) = NULL;
int (*w_mlx_device_tostring_ptr)(mlx_string* str, mlx_device dev) = NULL;
bool (*w_mlx_device_equal_ptr)(mlx_device lhs, mlx_device rhs) = NULL;
int (*w_mlx_device_get_index_ptr)(int* index, mlx_device dev) = NULL;
int (*w_mlx_device_get_type_ptr)(mlx_device_type* type, mlx_device dev) = NULL;
int (*w_mlx_get_default_device_ptr)(mlx_device* dev) = NULL;
int (*w_mlx_set_default_device_ptr)(mlx_device dev) = NULL;
int (*w_mlx_detail_vmap_replace_ptr)(mlx_vector_array* res, const mlx_vector_array inputs, const mlx_vector_array s_inputs, const mlx_vector_array s_outputs, const int* in_axes, size_t in_axes_num, const int* out_axes, size_t out_axes_num) = NULL;
int (*w_mlx_detail_vmap_trace_ptr)(mlx_vector_array* res_0, mlx_vector_array* res_1, const mlx_closure fun, const mlx_vector_array inputs, const int* in_axes, size_t in_axes_num) = NULL;
mlx_map_string_to_array (*w_mlx_map_string_to_array_new_ptr)(void) = NULL;
int (*w_mlx_map_string_to_array_set_ptr)(mlx_map_string_to_array* map, const mlx_map_string_to_array src) = NULL;
int (*w_mlx_map_string_to_array_free_ptr)(mlx_map_string_to_array map) = NULL;
int (*w_mlx_map_string_to_array_insert_ptr)(mlx_map_string_to_array map, const char* key, const mlx_array value) = NULL;
int (*w_mlx_map_string_to_array_get_ptr)(mlx_array* value, const mlx_map_string_to_array map, const char* key) = NULL;
mlx_map_string_to_array_iterator (*w_mlx_map_string_to_array_iterator_new_ptr)(mlx_map_string_to_array map) = NULL;
int (*w_mlx_map_string_to_array_iterator_free_ptr)(mlx_map_string_to_array_iterator it) = NULL;
int (*w_mlx_map_string_to_array_iterator_next_ptr)(const char** key, mlx_array* value, mlx_map_string_to_array_iterator it) = NULL;
mlx_map_string_to_string (*w_mlx_map_string_to_string_new_ptr)(void) = NULL;
int (*w_mlx_map_string_to_string_set_ptr)(mlx_map_string_to_string* map, const mlx_map_string_to_string src) = NULL;
int (*w_mlx_map_string_to_string_free_ptr)(mlx_map_string_to_string map) = NULL;
int (*w_mlx_map_string_to_string_insert_ptr)(mlx_map_string_to_string map, const char* key, const char* value) = NULL;
int (*w_mlx_map_string_to_string_get_ptr)(const char** value, const mlx_map_string_to_string map, const char* key) = NULL;
mlx_map_string_to_string_iterator (*w_mlx_map_string_to_string_iterator_new_ptr)(mlx_map_string_to_string map) = NULL;
int (*w_mlx_map_string_to_string_iterator_free_ptr)(mlx_map_string_to_string_iterator it) = NULL;
int (*w_mlx_map_string_to_string_iterator_next_ptr)(const char** key, const char** value, mlx_map_string_to_string_iterator it) = NULL;
int (*w_mlx_distributed_group_rank_ptr)(mlx_distributed_group group) = NULL;
int (*w_mlx_distributed_group_size_ptr)(mlx_distributed_group group) = NULL;
mlx_distributed_group (*w_mlx_distributed_group_split_ptr)(mlx_distributed_group group, int color, int key) = NULL;
bool (*w_mlx_distributed_is_available_ptr)(void) = NULL;
mlx_distributed_group (*w_mlx_distributed_init_ptr)(bool strict) = NULL;
mlx_stream (*w_mlx_stream_new_ptr)(void) = NULL;
mlx_stream (*w_mlx_stream_new_device_ptr)(mlx_device dev) = NULL;
int (*w_mlx_stream_set_ptr)(mlx_stream* stream, const mlx_stream src) = NULL;
int (*w_mlx_stream_free_ptr)(mlx_stream stream) = NULL;
int (*w_mlx_stream_tostring_ptr)(mlx_string* str, mlx_stream stream) = NULL;
bool (*w_mlx_stream_equal_ptr)(mlx_stream lhs, mlx_stream rhs) = NULL;
int (*w_mlx_stream_get_device_ptr)(mlx_device* dev, mlx_stream stream) = NULL;
int (*w_mlx_stream_get_index_ptr)(int* index, mlx_stream stream) = NULL;
int (*w_mlx_synchronize_ptr)(mlx_stream stream) = NULL;
int (*w_mlx_get_default_stream_ptr)(mlx_stream* stream, mlx_device dev) = NULL;
int (*w_mlx_set_default_stream_ptr)(mlx_stream stream) = NULL;
mlx_stream (*w_mlx_default_cpu_stream_new_ptr)(void) = NULL;
mlx_stream (*w_mlx_default_gpu_stream_new_ptr)(void) = NULL;
int (*w_mlx_compile_ptr)(mlx_closure* res, const mlx_closure fun, bool shapeless) = NULL;
int (*w_mlx_detail_compile_ptr)(mlx_closure* res, const mlx_closure fun, uintptr_t fun_id, bool shapeless, const uint64_t* constants, size_t constants_num) = NULL;
int (*w_mlx_detail_compile_clear_cache_ptr)(void) = NULL;
int (*w_mlx_detail_compile_erase_ptr)(uintptr_t fun_id) = NULL;
int (*w_mlx_disable_compile_ptr)(void) = NULL;
int (*w_mlx_enable_compile_ptr)(void) = NULL;
int (*w_mlx_set_compile_mode_ptr)(mlx_compile_mode mode) = NULL;
mlx_io_reader (*w_mlx_io_reader_new_ptr)(void* desc, mlx_io_vtable vtable) = NULL;
int (*w_mlx_io_reader_descriptor_ptr)(void** desc_, mlx_io_reader io) = NULL;
int (*w_mlx_io_reader_tostring_ptr)(mlx_string* str_, mlx_io_reader io) = NULL;
int (*w_mlx_io_reader_free_ptr)(mlx_io_reader io) = NULL;
mlx_io_writer (*w_mlx_io_writer_new_ptr)(void* desc, mlx_io_vtable vtable) = NULL;
int (*w_mlx_io_writer_descriptor_ptr)(void** desc_, mlx_io_writer io) = NULL;
int (*w_mlx_io_writer_tostring_ptr)(mlx_string* str_, mlx_io_writer io) = NULL;
int (*w_mlx_io_writer_free_ptr)(mlx_io_writer io) = NULL;
int (*w_mlx_distributed_all_gather_ptr)(mlx_array* res, const mlx_array x, const mlx_distributed_group group , const mlx_stream S) = NULL;
int (*w_mlx_distributed_all_max_ptr)(mlx_array* res, const mlx_array x, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_all_min_ptr)(mlx_array* res, const mlx_array x, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_all_sum_ptr)(mlx_array* res, const mlx_array x, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_recv_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, int src, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_recv_like_ptr)(mlx_array* res, const mlx_array x, int src, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_send_ptr)(mlx_array* res, const mlx_array x, int dst, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_distributed_sum_scatter_ptr)(mlx_array* res, const mlx_array x, const mlx_distributed_group group , const mlx_stream s) = NULL;
int (*w_mlx_load_reader_ptr)(mlx_array* res, mlx_io_reader in_stream, const mlx_stream s) = NULL;
int (*w_mlx_load_ptr)(mlx_array* res, const char* file, const mlx_stream s) = NULL;
int (*w_mlx_load_safetensors_reader_ptr)(mlx_map_string_to_array* res_0, mlx_map_string_to_string* res_1, mlx_io_reader in_stream, const mlx_stream s) = NULL;
int (*w_mlx_load_safetensors_ptr)(mlx_map_string_to_array* res_0, mlx_map_string_to_string* res_1, const char* file, const mlx_stream s) = NULL;
int (*w_mlx_save_writer_ptr)(mlx_io_writer out_stream, const mlx_array a) = NULL;
int (*w_mlx_save_ptr)(const char* file, const mlx_array a) = NULL;
int (*w_mlx_save_safetensors_writer_ptr)(mlx_io_writer in_stream, const mlx_map_string_to_array param, const mlx_map_string_to_string metadata) = NULL;
int (*w_mlx_save_safetensors_ptr)(const char* file, const mlx_map_string_to_array param, const mlx_map_string_to_string metadata) = NULL;
size_t (*w_mlx_dtype_size_ptr)(mlx_dtype dtype) = NULL;
int (*w_mlx_array_tostring_ptr)(mlx_string* str, const mlx_array arr) = NULL;
mlx_array (*w_mlx_array_new_ptr)(void) = NULL;
int (*w_mlx_array_free_ptr)(mlx_array arr) = NULL;
mlx_array (*w_mlx_array_new_bool_ptr)(bool val) = NULL;
mlx_array (*w_mlx_array_new_int_ptr)(int val) = NULL;
mlx_array (*w_mlx_array_new_float32_ptr)(float val) = NULL;
mlx_array (*w_mlx_array_new_float_ptr)(float val) = NULL;
mlx_array (*w_mlx_array_new_float64_ptr)(double val) = NULL;
mlx_array (*w_mlx_array_new_double_ptr)(double val) = NULL;
mlx_array (*w_mlx_array_new_complex_ptr)(float real_val, float imag_val) = NULL;
mlx_array (*w_mlx_array_new_data_ptr)(const void* data, const int* shape, int dim, mlx_dtype dtype) = NULL;
int (*w_mlx_array_set_ptr)(mlx_array* arr, const mlx_array src) = NULL;
int (*w_mlx_array_set_bool_ptr)(mlx_array* arr, bool val) = NULL;
int (*w_mlx_array_set_int_ptr)(mlx_array* arr, int val) = NULL;
int (*w_mlx_array_set_float32_ptr)(mlx_array* arr, float val) = NULL;
int (*w_mlx_array_set_float_ptr)(mlx_array* arr, float val) = NULL;
int (*w_mlx_array_set_float64_ptr)(mlx_array* arr, double val) = NULL;
int (*w_mlx_array_set_double_ptr)(mlx_array* arr, double val) = NULL;
int (*w_mlx_array_set_complex_ptr)(mlx_array* arr, float real_val, float imag_val) = NULL;
int (*w_mlx_array_set_data_ptr)(mlx_array* arr, const void* data, const int* shape, int dim, mlx_dtype dtype) = NULL;
size_t (*w_mlx_array_itemsize_ptr)(const mlx_array arr) = NULL;
size_t (*w_mlx_array_size_ptr)(const mlx_array arr) = NULL;
size_t (*w_mlx_array_nbytes_ptr)(const mlx_array arr) = NULL;
size_t (*w_mlx_array_ndim_ptr)(const mlx_array arr) = NULL;
const int* (*w_mlx_array_shape_ptr)(const mlx_array arr) = NULL;
const size_t* (*w_mlx_array_strides_ptr)(const mlx_array arr) = NULL;
int (*w_mlx_array_dim_ptr)(const mlx_array arr, int dim) = NULL;
mlx_dtype (*w_mlx_array_dtype_ptr)(const mlx_array arr) = NULL;
int (*w_mlx_array_eval_ptr)(mlx_array arr) = NULL;
int (*w_mlx_array_item_bool_ptr)(bool* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_uint8_ptr)(uint8_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_uint16_ptr)(uint16_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_uint32_ptr)(uint32_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_uint64_ptr)(uint64_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_int8_ptr)(int8_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_int16_ptr)(int16_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_int32_ptr)(int32_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_int64_ptr)(int64_t* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_float32_ptr)(float* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_float64_ptr)(double* res, const mlx_array arr) = NULL;
int (*w_mlx_array_item_complex64_ptr)(float _Complex* res, const mlx_array arr) = NULL;
#if defined(__aarch64__) || defined(_M_ARM64)
int (*w_mlx_array_item_float16_ptr)(float16_t* res, const mlx_array arr) = NULL;
#endif
#if defined(__aarch64__) || defined(_M_ARM64)
int (*w_mlx_array_item_bfloat16_ptr)(bfloat16_t* res, const mlx_array arr) = NULL;
#endif
const bool* (*w_mlx_array_data_bool_ptr)(const mlx_array arr) = NULL;
const uint8_t* (*w_mlx_array_data_uint8_ptr)(const mlx_array arr) = NULL;
const uint16_t* (*w_mlx_array_data_uint16_ptr)(const mlx_array arr) = NULL;
const uint32_t* (*w_mlx_array_data_uint32_ptr)(const mlx_array arr) = NULL;
const uint64_t* (*w_mlx_array_data_uint64_ptr)(const mlx_array arr) = NULL;
const int8_t* (*w_mlx_array_data_int8_ptr)(const mlx_array arr) = NULL;
const int16_t* (*w_mlx_array_data_int16_ptr)(const mlx_array arr) = NULL;
const int32_t* (*w_mlx_array_data_int32_ptr)(const mlx_array arr) = NULL;
const int64_t* (*w_mlx_array_data_int64_ptr)(const mlx_array arr) = NULL;
const float* (*w_mlx_array_data_float32_ptr)(const mlx_array arr) = NULL;
const double* (*w_mlx_array_data_float64_ptr)(const mlx_array arr) = NULL;
const float _Complex* (*w_mlx_array_data_complex64_ptr)(const mlx_array arr) = NULL;
#if defined(__aarch64__) || defined(_M_ARM64)
const float16_t* (*w_mlx_array_data_float16_ptr)(const mlx_array arr) = NULL;
#endif
#if defined(__aarch64__) || defined(_M_ARM64)
const bfloat16_t* (*w_mlx_array_data_bfloat16_ptr)(const mlx_array arr) = NULL;
#endif
int (*w__mlx_array_is_available_ptr)(bool* res, const mlx_array arr) = NULL;
int (*w__mlx_array_wait_ptr)(const mlx_array arr) = NULL;
int (*w__mlx_array_is_contiguous_ptr)(bool* res, const mlx_array arr) = NULL;
int (*w__mlx_array_is_row_contiguous_ptr)(bool* res, const mlx_array arr) = NULL;
int (*w__mlx_array_is_col_contiguous_ptr)(bool* res, const mlx_array arr) = NULL;
int (*w_mlx_linalg_cholesky_ptr)(mlx_array* res, const mlx_array a, bool upper, const mlx_stream s) = NULL;
int (*w_mlx_linalg_cholesky_inv_ptr)(mlx_array* res, const mlx_array a, bool upper, const mlx_stream s) = NULL;
int (*w_mlx_linalg_cross_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, int axis, const mlx_stream s) = NULL;
int (*w_mlx_linalg_eig_ptr)(mlx_array* res_0, mlx_array* res_1, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_eigh_ptr)(mlx_array* res_0, mlx_array* res_1, const mlx_array a, const char* UPLO, const mlx_stream s) = NULL;
int (*w_mlx_linalg_eigvals_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_eigvalsh_ptr)(mlx_array* res, const mlx_array a, const char* UPLO, const mlx_stream s) = NULL;
int (*w_mlx_linalg_inv_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_lu_ptr)(mlx_vector_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_lu_factor_ptr)(mlx_array* res_0, mlx_array* res_1, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_norm_ptr)(mlx_array* res, const mlx_array a, double ord, const int* axis , size_t axis_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_linalg_norm_matrix_ptr)(mlx_array* res, const mlx_array a, const char* ord, const int* axis , size_t axis_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_linalg_norm_l2_ptr)(mlx_array* res, const mlx_array a, const int* axis , size_t axis_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_linalg_pinv_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_qr_ptr)(mlx_array* res_0, mlx_array* res_1, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_linalg_solve_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_linalg_solve_triangular_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, bool upper, const mlx_stream s) = NULL;
int (*w_mlx_linalg_svd_ptr)(mlx_vector_array* res, const mlx_array a, bool compute_uv, const mlx_stream s) = NULL;
int (*w_mlx_linalg_tri_inv_ptr)(mlx_array* res, const mlx_array a, bool upper, const mlx_stream s) = NULL;
int (*w_mlx_clear_cache_ptr)(void) = NULL;
int (*w_mlx_get_active_memory_ptr)(size_t* res) = NULL;
int (*w_mlx_get_cache_memory_ptr)(size_t* res) = NULL;
int (*w_mlx_get_memory_limit_ptr)(size_t* res) = NULL;
int (*w_mlx_get_peak_memory_ptr)(size_t* res) = NULL;
int (*w_mlx_reset_peak_memory_ptr)(void) = NULL;
int (*w_mlx_set_cache_limit_ptr)(size_t* res, size_t limit) = NULL;
int (*w_mlx_set_memory_limit_ptr)(size_t* res, size_t limit) = NULL;
int (*w_mlx_set_wired_limit_ptr)(size_t* res, size_t limit) = NULL;
mlx_closure (*w_mlx_closure_new_ptr)(void) = NULL;
int (*w_mlx_closure_free_ptr)(mlx_closure cls) = NULL;
mlx_closure (*w_mlx_closure_new_func_ptr)(int (*fun)(mlx_vector_array*, const mlx_vector_array)) = NULL;
mlx_closure (*w_mlx_closure_new_func_payload_ptr)(int (*fun)(mlx_vector_array*, const mlx_vector_array, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_set_ptr)(mlx_closure* cls, const mlx_closure src) = NULL;
int (*w_mlx_closure_apply_ptr)(mlx_vector_array* res, mlx_closure cls, const mlx_vector_array input) = NULL;
mlx_closure (*w_mlx_closure_new_unary_ptr)(int (*fun)(mlx_array*, const mlx_array)) = NULL;
mlx_closure_kwargs (*w_mlx_closure_kwargs_new_ptr)(void) = NULL;
int (*w_mlx_closure_kwargs_free_ptr)(mlx_closure_kwargs cls) = NULL;
mlx_closure_kwargs (*w_mlx_closure_kwargs_new_func_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_map_string_to_array)) = NULL;
mlx_closure_kwargs (*w_mlx_closure_kwargs_new_func_payload_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_map_string_to_array, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_kwargs_set_ptr)(mlx_closure_kwargs* cls, const mlx_closure_kwargs src) = NULL;
int (*w_mlx_closure_kwargs_apply_ptr)(mlx_vector_array* res, mlx_closure_kwargs cls, const mlx_vector_array input_0, const mlx_map_string_to_array input_1) = NULL;
mlx_closure_value_and_grad (*w_mlx_closure_value_and_grad_new_ptr)(void) = NULL;
int (*w_mlx_closure_value_and_grad_free_ptr)(mlx_closure_value_and_grad cls) = NULL;
mlx_closure_value_and_grad (*w_mlx_closure_value_and_grad_new_func_ptr)(int (*fun)(mlx_vector_array*, mlx_vector_array*, const mlx_vector_array)) = NULL;
mlx_closure_value_and_grad (*w_mlx_closure_value_and_grad_new_func_payload_ptr)(int (*fun)( mlx_vector_array*, mlx_vector_array*, const mlx_vector_array, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_value_and_grad_set_ptr)(mlx_closure_value_and_grad* cls, const mlx_closure_value_and_grad src) = NULL;
int (*w_mlx_closure_value_and_grad_apply_ptr)(mlx_vector_array* res_0, mlx_vector_array* res_1, mlx_closure_value_and_grad cls, const mlx_vector_array input) = NULL;
mlx_closure_custom (*w_mlx_closure_custom_new_ptr)(void) = NULL;
int (*w_mlx_closure_custom_free_ptr)(mlx_closure_custom cls) = NULL;
mlx_closure_custom (*w_mlx_closure_custom_new_func_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_vector_array, const mlx_vector_array)) = NULL;
mlx_closure_custom (*w_mlx_closure_custom_new_func_payload_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_vector_array, const mlx_vector_array, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_custom_set_ptr)(mlx_closure_custom* cls, const mlx_closure_custom src) = NULL;
int (*w_mlx_closure_custom_apply_ptr)(mlx_vector_array* res, mlx_closure_custom cls, const mlx_vector_array input_0, const mlx_vector_array input_1, const mlx_vector_array input_2) = NULL;
mlx_closure_custom_jvp (*w_mlx_closure_custom_jvp_new_ptr)(void) = NULL;
int (*w_mlx_closure_custom_jvp_free_ptr)(mlx_closure_custom_jvp cls) = NULL;
mlx_closure_custom_jvp (*w_mlx_closure_custom_jvp_new_func_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_vector_array, const int*, size_t _num)) = NULL;
mlx_closure_custom_jvp (*w_mlx_closure_custom_jvp_new_func_payload_ptr)(int (*fun)( mlx_vector_array*, const mlx_vector_array, const mlx_vector_array, const int*, size_t _num, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_custom_jvp_set_ptr)(mlx_closure_custom_jvp* cls, const mlx_closure_custom_jvp src) = NULL;
int (*w_mlx_closure_custom_jvp_apply_ptr)(mlx_vector_array* res, mlx_closure_custom_jvp cls, const mlx_vector_array input_0, const mlx_vector_array input_1, const int* input_2, size_t input_2_num) = NULL;
mlx_closure_custom_vmap (*w_mlx_closure_custom_vmap_new_ptr)(void) = NULL;
int (*w_mlx_closure_custom_vmap_free_ptr)(mlx_closure_custom_vmap cls) = NULL;
mlx_closure_custom_vmap (*w_mlx_closure_custom_vmap_new_func_ptr)(int (*fun)( mlx_vector_array*, mlx_vector_int*, const mlx_vector_array, const int*, size_t _num)) = NULL;
mlx_closure_custom_vmap (*w_mlx_closure_custom_vmap_new_func_payload_ptr)(int (*fun)( mlx_vector_array*, mlx_vector_int*, const mlx_vector_array, const int*, size_t _num, void*), void* payload, void (*dtor)(void*)) = NULL;
int (*w_mlx_closure_custom_vmap_set_ptr)(mlx_closure_custom_vmap* cls, const mlx_closure_custom_vmap src) = NULL;
int (*w_mlx_closure_custom_vmap_apply_ptr)(mlx_vector_array* res_0, mlx_vector_int* res_1, mlx_closure_custom_vmap cls, const mlx_vector_array input_0, const int* input_1, size_t input_1_num) = NULL;
int (*w_mlx_abs_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_add_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_addmm_ptr)(mlx_array* res, const mlx_array c, const mlx_array a, const mlx_array b, float alpha, float beta, const mlx_stream s) = NULL;
int (*w_mlx_all_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_all_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_all_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_allclose_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, double rtol, double atol, bool equal_nan, const mlx_stream s) = NULL;
int (*w_mlx_any_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_any_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_any_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_arange_ptr)(mlx_array* res, double start, double stop, double step, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_arccos_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_arccosh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_arcsin_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_arcsinh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_arctan_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_arctan2_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_arctanh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_argmax_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_argmax_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_argmin_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_argmin_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_argpartition_axis_ptr)(mlx_array* res, const mlx_array a, int kth, int axis, const mlx_stream s) = NULL;
int (*w_mlx_argpartition_ptr)(mlx_array* res, const mlx_array a, int kth, const mlx_stream s) = NULL;
int (*w_mlx_argsort_axis_ptr)(mlx_array* res, const mlx_array a, int axis, const mlx_stream s) = NULL;
int (*w_mlx_argsort_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_array_equal_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, bool equal_nan, const mlx_stream s) = NULL;
int (*w_mlx_as_strided_ptr)(mlx_array* res, const mlx_array a, const int* shape, size_t shape_num, const int64_t* strides, size_t strides_num, size_t offset, const mlx_stream s) = NULL;
int (*w_mlx_astype_ptr)(mlx_array* res, const mlx_array a, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_atleast_1d_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_atleast_2d_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_atleast_3d_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_bitwise_and_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_bitwise_invert_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_bitwise_or_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_bitwise_xor_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_block_masked_mm_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, int block_size, const mlx_array mask_out , const mlx_array mask_lhs , const mlx_array mask_rhs , const mlx_stream s) = NULL;
int (*w_mlx_broadcast_arrays_ptr)(mlx_vector_array* res, const mlx_vector_array inputs, const mlx_stream s) = NULL;
int (*w_mlx_broadcast_to_ptr)(mlx_array* res, const mlx_array a, const int* shape, size_t shape_num, const mlx_stream s) = NULL;
int (*w_mlx_ceil_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_clip_ptr)(mlx_array* res, const mlx_array a, const mlx_array a_min , const mlx_array a_max , const mlx_stream s) = NULL;
int (*w_mlx_concatenate_axis_ptr)(mlx_array* res, const mlx_vector_array arrays, int axis, const mlx_stream s) = NULL;
int (*w_mlx_concatenate_ptr)(mlx_array* res, const mlx_vector_array arrays, const mlx_stream s) = NULL;
int (*w_mlx_conjugate_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_contiguous_ptr)(mlx_array* res, const mlx_array a, bool allow_col_major, const mlx_stream s) = NULL;
int (*w_mlx_conv1d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride, int padding, int dilation, int groups, const mlx_stream s) = NULL;
int (*w_mlx_conv2d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride_0, int stride_1, int padding_0, int padding_1, int dilation_0, int dilation_1, int groups, const mlx_stream s) = NULL;
int (*w_mlx_conv3d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride_0, int stride_1, int stride_2, int padding_0, int padding_1, int padding_2, int dilation_0, int dilation_1, int dilation_2, int groups, const mlx_stream s) = NULL;
int (*w_mlx_conv_general_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, const int* stride, size_t stride_num, const int* padding_lo, size_t padding_lo_num, const int* padding_hi, size_t padding_hi_num, const int* kernel_dilation, size_t kernel_dilation_num, const int* input_dilation, size_t input_dilation_num, int groups, bool flip, const mlx_stream s) = NULL;
int (*w_mlx_conv_transpose1d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride, int padding, int dilation, int output_padding, int groups, const mlx_stream s) = NULL;
int (*w_mlx_conv_transpose2d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride_0, int stride_1, int padding_0, int padding_1, int dilation_0, int dilation_1, int output_padding_0, int output_padding_1, int groups, const mlx_stream s) = NULL;
int (*w_mlx_conv_transpose3d_ptr)(mlx_array* res, const mlx_array input, const mlx_array weight, int stride_0, int stride_1, int stride_2, int padding_0, int padding_1, int padding_2, int dilation_0, int dilation_1, int dilation_2, int output_padding_0, int output_padding_1, int output_padding_2, int groups, const mlx_stream s) = NULL;
int (*w_mlx_copy_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_cos_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_cosh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_cummax_ptr)(mlx_array* res, const mlx_array a, int axis, bool reverse, bool inclusive, const mlx_stream s) = NULL;
int (*w_mlx_cummin_ptr)(mlx_array* res, const mlx_array a, int axis, bool reverse, bool inclusive, const mlx_stream s) = NULL;
int (*w_mlx_cumprod_ptr)(mlx_array* res, const mlx_array a, int axis, bool reverse, bool inclusive, const mlx_stream s) = NULL;
int (*w_mlx_cumsum_ptr)(mlx_array* res, const mlx_array a, int axis, bool reverse, bool inclusive, const mlx_stream s) = NULL;
int (*w_mlx_degrees_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_depends_ptr)(mlx_vector_array* res, const mlx_vector_array inputs, const mlx_vector_array dependencies) = NULL;
int (*w_mlx_dequantize_ptr)(mlx_array* res, const mlx_array w, const mlx_array scales, const mlx_array biases , mlx_optional_int group_size, mlx_optional_int bits, const char* mode, mlx_optional_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_diag_ptr)(mlx_array* res, const mlx_array a, int k, const mlx_stream s) = NULL;
int (*w_mlx_diagonal_ptr)(mlx_array* res, const mlx_array a, int offset, int axis1, int axis2, const mlx_stream s) = NULL;
int (*w_mlx_divide_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_divmod_ptr)(mlx_vector_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_einsum_ptr)(mlx_array* res, const char* subscripts, const mlx_vector_array operands, const mlx_stream s) = NULL;
int (*w_mlx_equal_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_erf_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_erfinv_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_exp_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_expand_dims_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_expand_dims_ptr)(mlx_array* res, const mlx_array a, int axis, const mlx_stream s) = NULL;
int (*w_mlx_expm1_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_eye_ptr)(mlx_array* res, int n, int m, int k, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_flatten_ptr)(mlx_array* res, const mlx_array a, int start_axis, int end_axis, const mlx_stream s) = NULL;
int (*w_mlx_floor_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_floor_divide_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_from_fp8_ptr)(mlx_array* res, const mlx_array x, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_full_ptr)(mlx_array* res, const int* shape, size_t shape_num, const mlx_array vals, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_full_like_ptr)(mlx_array* res, const mlx_array a, const mlx_array vals, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_gather_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const int* axes, size_t axes_num, const int* slice_sizes, size_t slice_sizes_num, const mlx_stream s) = NULL;
int (*w_mlx_gather_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, int axis, const int* slice_sizes, size_t slice_sizes_num, const mlx_stream s) = NULL;
int (*w_mlx_gather_mm_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_array lhs_indices , const mlx_array rhs_indices , bool sorted_indices, const mlx_stream s) = NULL;
int (*w_mlx_gather_qmm_ptr)(mlx_array* res, const mlx_array x, const mlx_array w, const mlx_array scales, const mlx_array biases , const mlx_array lhs_indices , const mlx_array rhs_indices , bool transpose, mlx_optional_int group_size, mlx_optional_int bits, const char* mode, bool sorted_indices, const mlx_stream s) = NULL;
int (*w_mlx_greater_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_greater_equal_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_hadamard_transform_ptr)(mlx_array* res, const mlx_array a, mlx_optional_float scale, const mlx_stream s) = NULL;
int (*w_mlx_identity_ptr)(mlx_array* res, int n, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_imag_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_inner_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_isclose_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, double rtol, double atol, bool equal_nan, const mlx_stream s) = NULL;
int (*w_mlx_isfinite_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_isinf_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_isnan_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_isneginf_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_isposinf_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_kron_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_left_shift_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_less_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_less_equal_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_linspace_ptr)(mlx_array* res, double start, double stop, int num, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_log_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_log10_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_log1p_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_log2_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_logaddexp_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_logcumsumexp_ptr)(mlx_array* res, const mlx_array a, int axis, bool reverse, bool inclusive, const mlx_stream s) = NULL;
int (*w_mlx_logical_and_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_logical_not_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_logical_or_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_logsumexp_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_logsumexp_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_logsumexp_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_masked_scatter_ptr)(mlx_array* res, const mlx_array a, const mlx_array mask, const mlx_array src, const mlx_stream s) = NULL;
int (*w_mlx_matmul_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_max_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_max_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_max_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_maximum_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_mean_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_mean_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_mean_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_median_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_meshgrid_ptr)(mlx_vector_array* res, const mlx_vector_array arrays, bool sparse, const char* indexing, const mlx_stream s) = NULL;
int (*w_mlx_min_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_min_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_min_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_minimum_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_moveaxis_ptr)(mlx_array* res, const mlx_array a, int source, int destination, const mlx_stream s) = NULL;
int (*w_mlx_multiply_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_nan_to_num_ptr)(mlx_array* res, const mlx_array a, float nan, mlx_optional_float posinf, mlx_optional_float neginf, const mlx_stream s) = NULL;
int (*w_mlx_negative_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_not_equal_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_number_of_elements_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool inverted, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_ones_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_ones_like_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_outer_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_pad_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const int* low_pad_size, size_t low_pad_size_num, const int* high_pad_size, size_t high_pad_size_num, const mlx_array pad_value, const char* mode, const mlx_stream s) = NULL;
int (*w_mlx_pad_symmetric_ptr)(mlx_array* res, const mlx_array a, int pad_width, const mlx_array pad_value, const char* mode, const mlx_stream s) = NULL;
int (*w_mlx_partition_axis_ptr)(mlx_array* res, const mlx_array a, int kth, int axis, const mlx_stream s) = NULL;
int (*w_mlx_partition_ptr)(mlx_array* res, const mlx_array a, int kth, const mlx_stream s) = NULL;
int (*w_mlx_power_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_prod_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_prod_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_prod_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_put_along_axis_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array values, int axis, const mlx_stream s) = NULL;
int (*w_mlx_qqmm_ptr)(mlx_array* res, const mlx_array x, const mlx_array w, const mlx_array w_scales , mlx_optional_int group_size, mlx_optional_int bits, const char* mode, const mlx_stream s) = NULL;
int (*w_mlx_quantize_ptr)(mlx_vector_array* res, const mlx_array w, mlx_optional_int group_size, mlx_optional_int bits, const char* mode, const mlx_stream s) = NULL;
int (*w_mlx_quantized_matmul_ptr)(mlx_array* res, const mlx_array x, const mlx_array w, const mlx_array scales, const mlx_array biases , bool transpose, mlx_optional_int group_size, mlx_optional_int bits, const char* mode, const mlx_stream s) = NULL;
int (*w_mlx_radians_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_real_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_reciprocal_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_remainder_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_repeat_axis_ptr)(mlx_array* res, const mlx_array arr, int repeats, int axis, const mlx_stream s) = NULL;
int (*w_mlx_repeat_ptr)(mlx_array* res, const mlx_array arr, int repeats, const mlx_stream s) = NULL;
int (*w_mlx_reshape_ptr)(mlx_array* res, const mlx_array a, const int* shape, size_t shape_num, const mlx_stream s) = NULL;
int (*w_mlx_right_shift_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_roll_axis_ptr)(mlx_array* res, const mlx_array a, const int* shift, size_t shift_num, int axis, const mlx_stream s) = NULL;
int (*w_mlx_roll_axes_ptr)(mlx_array* res, const mlx_array a, const int* shift, size_t shift_num, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_roll_ptr)(mlx_array* res, const mlx_array a, const int* shift, size_t shift_num, const mlx_stream s) = NULL;
int (*w_mlx_round_ptr)(mlx_array* res, const mlx_array a, int decimals, const mlx_stream s) = NULL;
int (*w_mlx_rsqrt_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_scatter_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const mlx_array updates, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_scatter_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array updates, int axis, const mlx_stream s) = NULL;
int (*w_mlx_scatter_add_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const mlx_array updates, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_scatter_add_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array updates, int axis, const mlx_stream s) = NULL;
int (*w_mlx_scatter_add_axis_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array values, int axis, const mlx_stream s) = NULL;
int (*w_mlx_scatter_max_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const mlx_array updates, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_scatter_max_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array updates, int axis, const mlx_stream s) = NULL;
int (*w_mlx_scatter_min_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const mlx_array updates, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_scatter_min_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array updates, int axis, const mlx_stream s) = NULL;
int (*w_mlx_scatter_prod_ptr)(mlx_array* res, const mlx_array a, const mlx_vector_array indices, const mlx_array updates, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_scatter_prod_single_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_array updates, int axis, const mlx_stream s) = NULL;
int (*w_mlx_segmented_mm_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_array segments, const mlx_stream s) = NULL;
int (*w_mlx_sigmoid_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_sign_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_sin_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_sinh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_slice_ptr)(mlx_array* res, const mlx_array a, const int* start, size_t start_num, const int* stop, size_t stop_num, const int* strides, size_t strides_num, const mlx_stream s) = NULL;
int (*w_mlx_slice_dynamic_ptr)(mlx_array* res, const mlx_array a, const mlx_array start, const int* axes, size_t axes_num, const int* slice_size, size_t slice_size_num, const mlx_stream s) = NULL;
int (*w_mlx_slice_update_ptr)(mlx_array* res, const mlx_array src, const mlx_array update, const int* start, size_t start_num, const int* stop, size_t stop_num, const int* strides, size_t strides_num, const mlx_stream s) = NULL;
int (*w_mlx_slice_update_dynamic_ptr)(mlx_array* res, const mlx_array src, const mlx_array update, const mlx_array start, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_softmax_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool precise, const mlx_stream s) = NULL;
int (*w_mlx_softmax_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool precise, const mlx_stream s) = NULL;
int (*w_mlx_softmax_ptr)(mlx_array* res, const mlx_array a, bool precise, const mlx_stream s) = NULL;
int (*w_mlx_sort_axis_ptr)(mlx_array* res, const mlx_array a, int axis, const mlx_stream s) = NULL;
int (*w_mlx_sort_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_split_ptr)(mlx_vector_array* res, const mlx_array a, int num_splits, int axis, const mlx_stream s) = NULL;
int (*w_mlx_split_sections_ptr)(mlx_vector_array* res, const mlx_array a, const int* indices, size_t indices_num, int axis, const mlx_stream s) = NULL;
int (*w_mlx_sqrt_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_square_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_squeeze_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_squeeze_axis_ptr)(mlx_array* res, const mlx_array a, int axis, const mlx_stream s) = NULL;
int (*w_mlx_squeeze_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_stack_axis_ptr)(mlx_array* res, const mlx_vector_array arrays, int axis, const mlx_stream s) = NULL;
int (*w_mlx_stack_ptr)(mlx_array* res, const mlx_vector_array arrays, const mlx_stream s) = NULL;
int (*w_mlx_std_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_std_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_std_ptr)(mlx_array* res, const mlx_array a, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_stop_gradient_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_subtract_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const mlx_stream s) = NULL;
int (*w_mlx_sum_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_sum_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_sum_ptr)(mlx_array* res, const mlx_array a, bool keepdims, const mlx_stream s) = NULL;
int (*w_mlx_swapaxes_ptr)(mlx_array* res, const mlx_array a, int axis1, int axis2, const mlx_stream s) = NULL;
int (*w_mlx_take_axis_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, int axis, const mlx_stream s) = NULL;
int (*w_mlx_take_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, const mlx_stream s) = NULL;
int (*w_mlx_take_along_axis_ptr)(mlx_array* res, const mlx_array a, const mlx_array indices, int axis, const mlx_stream s) = NULL;
int (*w_mlx_tan_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_tanh_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_tensordot_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, const int* axes_a, size_t axes_a_num, const int* axes_b, size_t axes_b_num, const mlx_stream s) = NULL;
int (*w_mlx_tensordot_axis_ptr)(mlx_array* res, const mlx_array a, const mlx_array b, int axis, const mlx_stream s) = NULL;
int (*w_mlx_tile_ptr)(mlx_array* res, const mlx_array arr, const int* reps, size_t reps_num, const mlx_stream s) = NULL;
int (*w_mlx_to_fp8_ptr)(mlx_array* res, const mlx_array x, const mlx_stream s) = NULL;
int (*w_mlx_topk_axis_ptr)(mlx_array* res, const mlx_array a, int k, int axis, const mlx_stream s) = NULL;
int (*w_mlx_topk_ptr)(mlx_array* res, const mlx_array a, int k, const mlx_stream s) = NULL;
int (*w_mlx_trace_ptr)(mlx_array* res, const mlx_array a, int offset, int axis1, int axis2, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_transpose_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, const mlx_stream s) = NULL;
int (*w_mlx_transpose_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
int (*w_mlx_tri_ptr)(mlx_array* res, int n, int m, int k, mlx_dtype type, const mlx_stream s) = NULL;
int (*w_mlx_tril_ptr)(mlx_array* res, const mlx_array x, int k, const mlx_stream s) = NULL;
int (*w_mlx_triu_ptr)(mlx_array* res, const mlx_array x, int k, const mlx_stream s) = NULL;
int (*w_mlx_unflatten_ptr)(mlx_array* res, const mlx_array a, int axis, const int* shape, size_t shape_num, const mlx_stream s) = NULL;
int (*w_mlx_var_axes_ptr)(mlx_array* res, const mlx_array a, const int* axes, size_t axes_num, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_var_axis_ptr)(mlx_array* res, const mlx_array a, int axis, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_var_ptr)(mlx_array* res, const mlx_array a, bool keepdims, int ddof, const mlx_stream s) = NULL;
int (*w_mlx_view_ptr)(mlx_array* res, const mlx_array a, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_where_ptr)(mlx_array* res, const mlx_array condition, const mlx_array x, const mlx_array y, const mlx_stream s) = NULL;
int (*w_mlx_zeros_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_stream s) = NULL;
int (*w_mlx_zeros_like_ptr)(mlx_array* res, const mlx_array a, const mlx_stream s) = NULL;
mlx_metal_device_info_t (*w_mlx_metal_device_info_ptr)(void) = NULL;
int (*w_mlx_metal_is_available_ptr)(bool* res) = NULL;
int (*w_mlx_metal_start_capture_ptr)(const char* path) = NULL;
int (*w_mlx_metal_stop_capture_ptr)(void) = NULL;
mlx_vector_array (*w_mlx_vector_array_new_ptr)(void) = NULL;
int (*w_mlx_vector_array_set_ptr)(mlx_vector_array* vec, const mlx_vector_array src) = NULL;
int (*w_mlx_vector_array_free_ptr)(mlx_vector_array vec) = NULL;
mlx_vector_array (*w_mlx_vector_array_new_data_ptr)(const mlx_array* data, size_t size) = NULL;
mlx_vector_array (*w_mlx_vector_array_new_value_ptr)(const mlx_array val) = NULL;
int (*w_mlx_vector_array_set_data_ptr)(mlx_vector_array* vec, const mlx_array* data, size_t size) = NULL;
int (*w_mlx_vector_array_set_value_ptr)(mlx_vector_array* vec, const mlx_array val) = NULL;
int (*w_mlx_vector_array_append_data_ptr)(mlx_vector_array vec, const mlx_array* data, size_t size) = NULL;
int (*w_mlx_vector_array_append_value_ptr)(mlx_vector_array vec, const mlx_array val) = NULL;
size_t (*w_mlx_vector_array_size_ptr)(mlx_vector_array vec) = NULL;
int (*w_mlx_vector_array_get_ptr)(mlx_array* res, const mlx_vector_array vec, size_t idx) = NULL;
mlx_vector_vector_array (*w_mlx_vector_vector_array_new_ptr)(void) = NULL;
int (*w_mlx_vector_vector_array_set_ptr)(mlx_vector_vector_array* vec, const mlx_vector_vector_array src) = NULL;
int (*w_mlx_vector_vector_array_free_ptr)(mlx_vector_vector_array vec) = NULL;
mlx_vector_vector_array (*w_mlx_vector_vector_array_new_data_ptr)(const mlx_vector_array* data, size_t size) = NULL;
mlx_vector_vector_array (*w_mlx_vector_vector_array_new_value_ptr)(const mlx_vector_array val) = NULL;
int (*w_mlx_vector_vector_array_set_data_ptr)(mlx_vector_vector_array* vec, const mlx_vector_array* data, size_t size) = NULL;
int (*w_mlx_vector_vector_array_set_value_ptr)(mlx_vector_vector_array* vec, const mlx_vector_array val) = NULL;
int (*w_mlx_vector_vector_array_append_data_ptr)(mlx_vector_vector_array vec, const mlx_vector_array* data, size_t size) = NULL;
int (*w_mlx_vector_vector_array_append_value_ptr)(mlx_vector_vector_array vec, const mlx_vector_array val) = NULL;
size_t (*w_mlx_vector_vector_array_size_ptr)(mlx_vector_vector_array vec) = NULL;
int (*w_mlx_vector_vector_array_get_ptr)(mlx_vector_array* res, const mlx_vector_vector_array vec, size_t idx) = NULL;
mlx_vector_int (*w_mlx_vector_int_new_ptr)(void) = NULL;
int (*w_mlx_vector_int_set_ptr)(mlx_vector_int* vec, const mlx_vector_int src) = NULL;
int (*w_mlx_vector_int_free_ptr)(mlx_vector_int vec) = NULL;
mlx_vector_int (*w_mlx_vector_int_new_data_ptr)(int* data, size_t size) = NULL;
mlx_vector_int (*w_mlx_vector_int_new_value_ptr)(int val) = NULL;
int (*w_mlx_vector_int_set_data_ptr)(mlx_vector_int* vec, int* data, size_t size) = NULL;
int (*w_mlx_vector_int_set_value_ptr)(mlx_vector_int* vec, int val) = NULL;
int (*w_mlx_vector_int_append_data_ptr)(mlx_vector_int vec, int* data, size_t size) = NULL;
int (*w_mlx_vector_int_append_value_ptr)(mlx_vector_int vec, int val) = NULL;
size_t (*w_mlx_vector_int_size_ptr)(mlx_vector_int vec) = NULL;
int (*w_mlx_vector_int_get_ptr)(int* res, const mlx_vector_int vec, size_t idx) = NULL;
mlx_vector_string (*w_mlx_vector_string_new_ptr)(void) = NULL;
int (*w_mlx_vector_string_set_ptr)(mlx_vector_string* vec, const mlx_vector_string src) = NULL;
int (*w_mlx_vector_string_free_ptr)(mlx_vector_string vec) = NULL;
mlx_vector_string (*w_mlx_vector_string_new_data_ptr)(const char** data, size_t size) = NULL;
mlx_vector_string (*w_mlx_vector_string_new_value_ptr)(const char* val) = NULL;
int (*w_mlx_vector_string_set_data_ptr)(mlx_vector_string* vec, const char** data, size_t size) = NULL;
int (*w_mlx_vector_string_set_value_ptr)(mlx_vector_string* vec, const char* val) = NULL;
int (*w_mlx_vector_string_append_data_ptr)(mlx_vector_string vec, const char** data, size_t size) = NULL;
int (*w_mlx_vector_string_append_value_ptr)(mlx_vector_string vec, const char* val) = NULL;
size_t (*w_mlx_vector_string_size_ptr)(mlx_vector_string vec) = NULL;
int (*w_mlx_vector_string_get_ptr)(char** res, const mlx_vector_string vec, size_t idx) = NULL;
int (*w_mlx_async_eval_ptr)(const mlx_vector_array outputs) = NULL;
int (*w_mlx_checkpoint_ptr)(mlx_closure* res, const mlx_closure fun) = NULL;
int (*w_mlx_custom_function_ptr)(mlx_closure* res, const mlx_closure fun, const mlx_closure_custom fun_vjp , const mlx_closure_custom_jvp fun_jvp , const mlx_closure_custom_vmap fun_vmap) = NULL;
int (*w_mlx_custom_vjp_ptr)(mlx_closure* res, const mlx_closure fun, const mlx_closure_custom fun_vjp) = NULL;
int (*w_mlx_eval_ptr)(const mlx_vector_array outputs) = NULL;
int (*w_mlx_jvp_ptr)(mlx_vector_array* res_0, mlx_vector_array* res_1, const mlx_closure fun, const mlx_vector_array primals, const mlx_vector_array tangents) = NULL;
int (*w_mlx_value_and_grad_ptr)(mlx_closure_value_and_grad* res, const mlx_closure fun, const int* argnums, size_t argnums_num) = NULL;
int (*w_mlx_vjp_ptr)(mlx_vector_array* res_0, mlx_vector_array* res_1, const mlx_closure fun, const mlx_vector_array primals, const mlx_vector_array cotangents) = NULL;
int (*w_mlx_random_bernoulli_ptr)(mlx_array* res, const mlx_array p, const int* shape, size_t shape_num, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_bits_ptr)(mlx_array* res, const int* shape, size_t shape_num, int width, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_categorical_shape_ptr)(mlx_array* res, const mlx_array logits, int axis, const int* shape, size_t shape_num, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_categorical_num_samples_ptr)(mlx_array* res, const mlx_array logits_, int axis, int num_samples, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_categorical_ptr)(mlx_array* res, const mlx_array logits, int axis, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_gumbel_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_key_ptr)(mlx_array* res, uint64_t seed) = NULL;
int (*w_mlx_random_laplace_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, float loc, float scale, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_multivariate_normal_ptr)(mlx_array* res, const mlx_array mean, const mlx_array cov, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_normal_broadcast_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array loc , const mlx_array scale , const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_normal_ptr)(mlx_array* res, const int* shape, size_t shape_num, mlx_dtype dtype, float loc, float scale, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_permutation_ptr)(mlx_array* res, const mlx_array x, int axis, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_permutation_arange_ptr)(mlx_array* res, int x, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_randint_ptr)(mlx_array* res, const mlx_array low, const mlx_array high, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_seed_ptr)(uint64_t seed) = NULL;
int (*w_mlx_random_split_num_ptr)(mlx_array* res, const mlx_array key, int num, const mlx_stream s) = NULL;
int (*w_mlx_random_split_ptr)(mlx_array* res_0, mlx_array* res_1, const mlx_array key, const mlx_stream s) = NULL;
int (*w_mlx_random_truncated_normal_ptr)(mlx_array* res, const mlx_array lower, const mlx_array upper, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array key , const mlx_stream s) = NULL;
int (*w_mlx_random_uniform_ptr)(mlx_array* res, const mlx_array low, const mlx_array high, const int* shape, size_t shape_num, mlx_dtype dtype, const mlx_array key , const mlx_stream s) = NULL;
mlx_string (*w_mlx_string_new_ptr)(void) = NULL;
mlx_string (*w_mlx_string_new_data_ptr)(const char* str) = NULL;
int (*w_mlx_string_set_ptr)(mlx_string* str, const mlx_string src) = NULL;
const char* (*w_mlx_string_data_ptr)(mlx_string str) = NULL;
int (*w_mlx_string_free_ptr)(mlx_string str) = NULL;

// Initialize all function pointers via dlsym
int mlx_load_functions(void* handle) {
    if (handle == NULL) {
        fprintf(stderr, "MLX: Invalid library handle\n");
        return -1;
    }

    w_mlx_fast_cuda_kernel_config_new_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_new");
    if (w_mlx_fast_cuda_kernel_config_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_new\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_free_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_free");
    if (w_mlx_fast_cuda_kernel_config_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_free\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_add_output_arg_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_add_output_arg");
    if (w_mlx_fast_cuda_kernel_config_add_output_arg_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_add_output_arg\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_set_grid_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_set_grid");
    if (w_mlx_fast_cuda_kernel_config_set_grid_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_set_grid\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_set_thread_group_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_set_thread_group");
    if (w_mlx_fast_cuda_kernel_config_set_thread_group_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_set_thread_group\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_set_init_value_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_set_init_value");
    if (w_mlx_fast_cuda_kernel_config_set_init_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_set_init_value\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_set_verbose_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_set_verbose");
    if (w_mlx_fast_cuda_kernel_config_set_verbose_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_set_verbose\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_add_template_arg_dtype_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_add_template_arg_dtype");
    if (w_mlx_fast_cuda_kernel_config_add_template_arg_dtype_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_add_template_arg_dtype\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_add_template_arg_int_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_add_template_arg_int");
    if (w_mlx_fast_cuda_kernel_config_add_template_arg_int_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_add_template_arg_int\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_config_add_template_arg_bool_ptr = dlsym(handle, "mlx_fast_cuda_kernel_config_add_template_arg_bool");
    if (w_mlx_fast_cuda_kernel_config_add_template_arg_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_config_add_template_arg_bool\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_new_ptr = dlsym(handle, "mlx_fast_cuda_kernel_new");
    if (w_mlx_fast_cuda_kernel_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_new\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_free_ptr = dlsym(handle, "mlx_fast_cuda_kernel_free");
    if (w_mlx_fast_cuda_kernel_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_free\n");
        return -1;
    }
    w_mlx_fast_cuda_kernel_apply_ptr = dlsym(handle, "mlx_fast_cuda_kernel_apply");
    if (w_mlx_fast_cuda_kernel_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_cuda_kernel_apply\n");
        return -1;
    }
    w_mlx_fast_layer_norm_ptr = dlsym(handle, "mlx_fast_layer_norm");
    if (w_mlx_fast_layer_norm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_layer_norm\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_new_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_new");
    if (w_mlx_fast_metal_kernel_config_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_new\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_free_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_free");
    if (w_mlx_fast_metal_kernel_config_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_free\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_add_output_arg_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_add_output_arg");
    if (w_mlx_fast_metal_kernel_config_add_output_arg_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_add_output_arg\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_set_grid_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_set_grid");
    if (w_mlx_fast_metal_kernel_config_set_grid_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_set_grid\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_set_thread_group_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_set_thread_group");
    if (w_mlx_fast_metal_kernel_config_set_thread_group_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_set_thread_group\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_set_init_value_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_set_init_value");
    if (w_mlx_fast_metal_kernel_config_set_init_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_set_init_value\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_set_verbose_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_set_verbose");
    if (w_mlx_fast_metal_kernel_config_set_verbose_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_set_verbose\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_add_template_arg_dtype_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_add_template_arg_dtype");
    if (w_mlx_fast_metal_kernel_config_add_template_arg_dtype_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_add_template_arg_dtype\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_add_template_arg_int_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_add_template_arg_int");
    if (w_mlx_fast_metal_kernel_config_add_template_arg_int_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_add_template_arg_int\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_config_add_template_arg_bool_ptr = dlsym(handle, "mlx_fast_metal_kernel_config_add_template_arg_bool");
    if (w_mlx_fast_metal_kernel_config_add_template_arg_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_config_add_template_arg_bool\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_new_ptr = dlsym(handle, "mlx_fast_metal_kernel_new");
    if (w_mlx_fast_metal_kernel_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_new\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_free_ptr = dlsym(handle, "mlx_fast_metal_kernel_free");
    if (w_mlx_fast_metal_kernel_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_free\n");
        return -1;
    }
    w_mlx_fast_metal_kernel_apply_ptr = dlsym(handle, "mlx_fast_metal_kernel_apply");
    if (w_mlx_fast_metal_kernel_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_metal_kernel_apply\n");
        return -1;
    }
    w_mlx_fast_rms_norm_ptr = dlsym(handle, "mlx_fast_rms_norm");
    if (w_mlx_fast_rms_norm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_rms_norm\n");
        return -1;
    }
    w_mlx_fast_rope_ptr = dlsym(handle, "mlx_fast_rope");
    if (w_mlx_fast_rope_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_rope\n");
        return -1;
    }
    w_mlx_fast_rope_dynamic_ptr = dlsym(handle, "mlx_fast_rope_dynamic");
    if (w_mlx_fast_rope_dynamic_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_rope_dynamic\n");
        return -1;
    }
    w_mlx_fast_scaled_dot_product_attention_ptr = dlsym(handle, "mlx_fast_scaled_dot_product_attention");
    if (w_mlx_fast_scaled_dot_product_attention_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fast_scaled_dot_product_attention\n");
        return -1;
    }
    w_mlx_set_error_handler_ptr = dlsym(handle, "mlx_set_error_handler");
    if (w_mlx_set_error_handler_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_error_handler\n");
        return -1;
    }
    w__mlx_error_ptr = dlsym(handle, "_mlx_error");
    if (w__mlx_error_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_error\n");
        return -1;
    }
    w_mlx_fft_fft_ptr = dlsym(handle, "mlx_fft_fft");
    if (w_mlx_fft_fft_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_fft\n");
        return -1;
    }
    w_mlx_fft_fft2_ptr = dlsym(handle, "mlx_fft_fft2");
    if (w_mlx_fft_fft2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_fft2\n");
        return -1;
    }
    w_mlx_fft_fftn_ptr = dlsym(handle, "mlx_fft_fftn");
    if (w_mlx_fft_fftn_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_fftn\n");
        return -1;
    }
    w_mlx_fft_fftshift_ptr = dlsym(handle, "mlx_fft_fftshift");
    if (w_mlx_fft_fftshift_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_fftshift\n");
        return -1;
    }
    w_mlx_fft_ifft_ptr = dlsym(handle, "mlx_fft_ifft");
    if (w_mlx_fft_ifft_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_ifft\n");
        return -1;
    }
    w_mlx_fft_ifft2_ptr = dlsym(handle, "mlx_fft_ifft2");
    if (w_mlx_fft_ifft2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_ifft2\n");
        return -1;
    }
    w_mlx_fft_ifftn_ptr = dlsym(handle, "mlx_fft_ifftn");
    if (w_mlx_fft_ifftn_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_ifftn\n");
        return -1;
    }
    w_mlx_fft_ifftshift_ptr = dlsym(handle, "mlx_fft_ifftshift");
    if (w_mlx_fft_ifftshift_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_ifftshift\n");
        return -1;
    }
    w_mlx_fft_irfft_ptr = dlsym(handle, "mlx_fft_irfft");
    if (w_mlx_fft_irfft_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_irfft\n");
        return -1;
    }
    w_mlx_fft_irfft2_ptr = dlsym(handle, "mlx_fft_irfft2");
    if (w_mlx_fft_irfft2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_irfft2\n");
        return -1;
    }
    w_mlx_fft_irfftn_ptr = dlsym(handle, "mlx_fft_irfftn");
    if (w_mlx_fft_irfftn_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_irfftn\n");
        return -1;
    }
    w_mlx_fft_rfft_ptr = dlsym(handle, "mlx_fft_rfft");
    if (w_mlx_fft_rfft_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_rfft\n");
        return -1;
    }
    w_mlx_fft_rfft2_ptr = dlsym(handle, "mlx_fft_rfft2");
    if (w_mlx_fft_rfft2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_rfft2\n");
        return -1;
    }
    w_mlx_fft_rfftn_ptr = dlsym(handle, "mlx_fft_rfftn");
    if (w_mlx_fft_rfftn_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_fft_rfftn\n");
        return -1;
    }
    w_mlx_version_ptr = dlsym(handle, "mlx_version");
    if (w_mlx_version_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_version\n");
        return -1;
    }
    w_mlx_export_function_ptr = dlsym(handle, "mlx_export_function");
    if (w_mlx_export_function_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_export_function\n");
        return -1;
    }
    w_mlx_export_function_kwargs_ptr = dlsym(handle, "mlx_export_function_kwargs");
    if (w_mlx_export_function_kwargs_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_export_function_kwargs\n");
        return -1;
    }
    w_mlx_function_exporter_new_ptr = dlsym(handle, "mlx_function_exporter_new");
    if (w_mlx_function_exporter_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_function_exporter_new\n");
        return -1;
    }
    w_mlx_function_exporter_free_ptr = dlsym(handle, "mlx_function_exporter_free");
    if (w_mlx_function_exporter_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_function_exporter_free\n");
        return -1;
    }
    w_mlx_function_exporter_apply_ptr = dlsym(handle, "mlx_function_exporter_apply");
    if (w_mlx_function_exporter_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_function_exporter_apply\n");
        return -1;
    }
    w_mlx_function_exporter_apply_kwargs_ptr = dlsym(handle, "mlx_function_exporter_apply_kwargs");
    if (w_mlx_function_exporter_apply_kwargs_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_function_exporter_apply_kwargs\n");
        return -1;
    }
    w_mlx_imported_function_new_ptr = dlsym(handle, "mlx_imported_function_new");
    if (w_mlx_imported_function_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_imported_function_new\n");
        return -1;
    }
    w_mlx_imported_function_free_ptr = dlsym(handle, "mlx_imported_function_free");
    if (w_mlx_imported_function_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_imported_function_free\n");
        return -1;
    }
    w_mlx_imported_function_apply_ptr = dlsym(handle, "mlx_imported_function_apply");
    if (w_mlx_imported_function_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_imported_function_apply\n");
        return -1;
    }
    w_mlx_imported_function_apply_kwargs_ptr = dlsym(handle, "mlx_imported_function_apply_kwargs");
    if (w_mlx_imported_function_apply_kwargs_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_imported_function_apply_kwargs\n");
        return -1;
    }
    w_mlx_device_new_ptr = dlsym(handle, "mlx_device_new");
    if (w_mlx_device_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_new\n");
        return -1;
    }
    w_mlx_device_new_type_ptr = dlsym(handle, "mlx_device_new_type");
    if (w_mlx_device_new_type_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_new_type\n");
        return -1;
    }
    w_mlx_device_free_ptr = dlsym(handle, "mlx_device_free");
    if (w_mlx_device_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_free\n");
        return -1;
    }
    w_mlx_device_set_ptr = dlsym(handle, "mlx_device_set");
    if (w_mlx_device_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_set\n");
        return -1;
    }
    w_mlx_device_tostring_ptr = dlsym(handle, "mlx_device_tostring");
    if (w_mlx_device_tostring_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_tostring\n");
        return -1;
    }
    w_mlx_device_equal_ptr = dlsym(handle, "mlx_device_equal");
    if (w_mlx_device_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_equal\n");
        return -1;
    }
    w_mlx_device_get_index_ptr = dlsym(handle, "mlx_device_get_index");
    if (w_mlx_device_get_index_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_get_index\n");
        return -1;
    }
    w_mlx_device_get_type_ptr = dlsym(handle, "mlx_device_get_type");
    if (w_mlx_device_get_type_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_device_get_type\n");
        return -1;
    }
    w_mlx_get_default_device_ptr = dlsym(handle, "mlx_get_default_device");
    if (w_mlx_get_default_device_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_default_device\n");
        return -1;
    }
    w_mlx_set_default_device_ptr = dlsym(handle, "mlx_set_default_device");
    if (w_mlx_set_default_device_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_default_device\n");
        return -1;
    }
    w_mlx_detail_vmap_replace_ptr = dlsym(handle, "mlx_detail_vmap_replace");
    if (w_mlx_detail_vmap_replace_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_detail_vmap_replace\n");
        return -1;
    }
    w_mlx_detail_vmap_trace_ptr = dlsym(handle, "mlx_detail_vmap_trace");
    if (w_mlx_detail_vmap_trace_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_detail_vmap_trace\n");
        return -1;
    }
    w_mlx_map_string_to_array_new_ptr = dlsym(handle, "mlx_map_string_to_array_new");
    if (w_mlx_map_string_to_array_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_new\n");
        return -1;
    }
    w_mlx_map_string_to_array_set_ptr = dlsym(handle, "mlx_map_string_to_array_set");
    if (w_mlx_map_string_to_array_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_set\n");
        return -1;
    }
    w_mlx_map_string_to_array_free_ptr = dlsym(handle, "mlx_map_string_to_array_free");
    if (w_mlx_map_string_to_array_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_free\n");
        return -1;
    }
    w_mlx_map_string_to_array_insert_ptr = dlsym(handle, "mlx_map_string_to_array_insert");
    if (w_mlx_map_string_to_array_insert_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_insert\n");
        return -1;
    }
    w_mlx_map_string_to_array_get_ptr = dlsym(handle, "mlx_map_string_to_array_get");
    if (w_mlx_map_string_to_array_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_get\n");
        return -1;
    }
    w_mlx_map_string_to_array_iterator_new_ptr = dlsym(handle, "mlx_map_string_to_array_iterator_new");
    if (w_mlx_map_string_to_array_iterator_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_iterator_new\n");
        return -1;
    }
    w_mlx_map_string_to_array_iterator_free_ptr = dlsym(handle, "mlx_map_string_to_array_iterator_free");
    if (w_mlx_map_string_to_array_iterator_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_iterator_free\n");
        return -1;
    }
    w_mlx_map_string_to_array_iterator_next_ptr = dlsym(handle, "mlx_map_string_to_array_iterator_next");
    if (w_mlx_map_string_to_array_iterator_next_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_array_iterator_next\n");
        return -1;
    }
    w_mlx_map_string_to_string_new_ptr = dlsym(handle, "mlx_map_string_to_string_new");
    if (w_mlx_map_string_to_string_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_new\n");
        return -1;
    }
    w_mlx_map_string_to_string_set_ptr = dlsym(handle, "mlx_map_string_to_string_set");
    if (w_mlx_map_string_to_string_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_set\n");
        return -1;
    }
    w_mlx_map_string_to_string_free_ptr = dlsym(handle, "mlx_map_string_to_string_free");
    if (w_mlx_map_string_to_string_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_free\n");
        return -1;
    }
    w_mlx_map_string_to_string_insert_ptr = dlsym(handle, "mlx_map_string_to_string_insert");
    if (w_mlx_map_string_to_string_insert_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_insert\n");
        return -1;
    }
    w_mlx_map_string_to_string_get_ptr = dlsym(handle, "mlx_map_string_to_string_get");
    if (w_mlx_map_string_to_string_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_get\n");
        return -1;
    }
    w_mlx_map_string_to_string_iterator_new_ptr = dlsym(handle, "mlx_map_string_to_string_iterator_new");
    if (w_mlx_map_string_to_string_iterator_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_iterator_new\n");
        return -1;
    }
    w_mlx_map_string_to_string_iterator_free_ptr = dlsym(handle, "mlx_map_string_to_string_iterator_free");
    if (w_mlx_map_string_to_string_iterator_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_iterator_free\n");
        return -1;
    }
    w_mlx_map_string_to_string_iterator_next_ptr = dlsym(handle, "mlx_map_string_to_string_iterator_next");
    if (w_mlx_map_string_to_string_iterator_next_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_map_string_to_string_iterator_next\n");
        return -1;
    }
    w_mlx_distributed_group_rank_ptr = dlsym(handle, "mlx_distributed_group_rank");
    if (w_mlx_distributed_group_rank_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_group_rank\n");
        return -1;
    }
    w_mlx_distributed_group_size_ptr = dlsym(handle, "mlx_distributed_group_size");
    if (w_mlx_distributed_group_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_group_size\n");
        return -1;
    }
    w_mlx_distributed_group_split_ptr = dlsym(handle, "mlx_distributed_group_split");
    if (w_mlx_distributed_group_split_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_group_split\n");
        return -1;
    }
    w_mlx_distributed_is_available_ptr = dlsym(handle, "mlx_distributed_is_available");
    if (w_mlx_distributed_is_available_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_is_available\n");
        return -1;
    }
    w_mlx_distributed_init_ptr = dlsym(handle, "mlx_distributed_init");
    if (w_mlx_distributed_init_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_init\n");
        return -1;
    }
    w_mlx_stream_new_ptr = dlsym(handle, "mlx_stream_new");
    if (w_mlx_stream_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_new\n");
        return -1;
    }
    w_mlx_stream_new_device_ptr = dlsym(handle, "mlx_stream_new_device");
    if (w_mlx_stream_new_device_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_new_device\n");
        return -1;
    }
    w_mlx_stream_set_ptr = dlsym(handle, "mlx_stream_set");
    if (w_mlx_stream_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_set\n");
        return -1;
    }
    w_mlx_stream_free_ptr = dlsym(handle, "mlx_stream_free");
    if (w_mlx_stream_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_free\n");
        return -1;
    }
    w_mlx_stream_tostring_ptr = dlsym(handle, "mlx_stream_tostring");
    if (w_mlx_stream_tostring_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_tostring\n");
        return -1;
    }
    w_mlx_stream_equal_ptr = dlsym(handle, "mlx_stream_equal");
    if (w_mlx_stream_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_equal\n");
        return -1;
    }
    w_mlx_stream_get_device_ptr = dlsym(handle, "mlx_stream_get_device");
    if (w_mlx_stream_get_device_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_get_device\n");
        return -1;
    }
    w_mlx_stream_get_index_ptr = dlsym(handle, "mlx_stream_get_index");
    if (w_mlx_stream_get_index_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stream_get_index\n");
        return -1;
    }
    w_mlx_synchronize_ptr = dlsym(handle, "mlx_synchronize");
    if (w_mlx_synchronize_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_synchronize\n");
        return -1;
    }
    w_mlx_get_default_stream_ptr = dlsym(handle, "mlx_get_default_stream");
    if (w_mlx_get_default_stream_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_default_stream\n");
        return -1;
    }
    w_mlx_set_default_stream_ptr = dlsym(handle, "mlx_set_default_stream");
    if (w_mlx_set_default_stream_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_default_stream\n");
        return -1;
    }
    w_mlx_default_cpu_stream_new_ptr = dlsym(handle, "mlx_default_cpu_stream_new");
    if (w_mlx_default_cpu_stream_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_default_cpu_stream_new\n");
        return -1;
    }
    w_mlx_default_gpu_stream_new_ptr = dlsym(handle, "mlx_default_gpu_stream_new");
    if (w_mlx_default_gpu_stream_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_default_gpu_stream_new\n");
        return -1;
    }
    w_mlx_compile_ptr = dlsym(handle, "mlx_compile");
    if (w_mlx_compile_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_compile\n");
        return -1;
    }
    w_mlx_detail_compile_ptr = dlsym(handle, "mlx_detail_compile");
    if (w_mlx_detail_compile_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_detail_compile\n");
        return -1;
    }
    w_mlx_detail_compile_clear_cache_ptr = dlsym(handle, "mlx_detail_compile_clear_cache");
    if (w_mlx_detail_compile_clear_cache_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_detail_compile_clear_cache\n");
        return -1;
    }
    w_mlx_detail_compile_erase_ptr = dlsym(handle, "mlx_detail_compile_erase");
    if (w_mlx_detail_compile_erase_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_detail_compile_erase\n");
        return -1;
    }
    w_mlx_disable_compile_ptr = dlsym(handle, "mlx_disable_compile");
    if (w_mlx_disable_compile_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_disable_compile\n");
        return -1;
    }
    w_mlx_enable_compile_ptr = dlsym(handle, "mlx_enable_compile");
    if (w_mlx_enable_compile_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_enable_compile\n");
        return -1;
    }
    w_mlx_set_compile_mode_ptr = dlsym(handle, "mlx_set_compile_mode");
    if (w_mlx_set_compile_mode_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_compile_mode\n");
        return -1;
    }
    w_mlx_io_reader_new_ptr = dlsym(handle, "mlx_io_reader_new");
    if (w_mlx_io_reader_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_reader_new\n");
        return -1;
    }
    w_mlx_io_reader_descriptor_ptr = dlsym(handle, "mlx_io_reader_descriptor");
    if (w_mlx_io_reader_descriptor_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_reader_descriptor\n");
        return -1;
    }
    w_mlx_io_reader_tostring_ptr = dlsym(handle, "mlx_io_reader_tostring");
    if (w_mlx_io_reader_tostring_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_reader_tostring\n");
        return -1;
    }
    w_mlx_io_reader_free_ptr = dlsym(handle, "mlx_io_reader_free");
    if (w_mlx_io_reader_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_reader_free\n");
        return -1;
    }
    w_mlx_io_writer_new_ptr = dlsym(handle, "mlx_io_writer_new");
    if (w_mlx_io_writer_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_writer_new\n");
        return -1;
    }
    w_mlx_io_writer_descriptor_ptr = dlsym(handle, "mlx_io_writer_descriptor");
    if (w_mlx_io_writer_descriptor_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_writer_descriptor\n");
        return -1;
    }
    w_mlx_io_writer_tostring_ptr = dlsym(handle, "mlx_io_writer_tostring");
    if (w_mlx_io_writer_tostring_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_writer_tostring\n");
        return -1;
    }
    w_mlx_io_writer_free_ptr = dlsym(handle, "mlx_io_writer_free");
    if (w_mlx_io_writer_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_io_writer_free\n");
        return -1;
    }
    w_mlx_distributed_all_gather_ptr = dlsym(handle, "mlx_distributed_all_gather");
    if (w_mlx_distributed_all_gather_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_all_gather\n");
        return -1;
    }
    w_mlx_distributed_all_max_ptr = dlsym(handle, "mlx_distributed_all_max");
    if (w_mlx_distributed_all_max_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_all_max\n");
        return -1;
    }
    w_mlx_distributed_all_min_ptr = dlsym(handle, "mlx_distributed_all_min");
    if (w_mlx_distributed_all_min_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_all_min\n");
        return -1;
    }
    w_mlx_distributed_all_sum_ptr = dlsym(handle, "mlx_distributed_all_sum");
    if (w_mlx_distributed_all_sum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_all_sum\n");
        return -1;
    }
    w_mlx_distributed_recv_ptr = dlsym(handle, "mlx_distributed_recv");
    if (w_mlx_distributed_recv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_recv\n");
        return -1;
    }
    w_mlx_distributed_recv_like_ptr = dlsym(handle, "mlx_distributed_recv_like");
    if (w_mlx_distributed_recv_like_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_recv_like\n");
        return -1;
    }
    w_mlx_distributed_send_ptr = dlsym(handle, "mlx_distributed_send");
    if (w_mlx_distributed_send_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_send\n");
        return -1;
    }
    w_mlx_distributed_sum_scatter_ptr = dlsym(handle, "mlx_distributed_sum_scatter");
    if (w_mlx_distributed_sum_scatter_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_distributed_sum_scatter\n");
        return -1;
    }
    w_mlx_load_reader_ptr = dlsym(handle, "mlx_load_reader");
    if (w_mlx_load_reader_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_load_reader\n");
        return -1;
    }
    w_mlx_load_ptr = dlsym(handle, "mlx_load");
    if (w_mlx_load_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_load\n");
        return -1;
    }
    w_mlx_load_safetensors_reader_ptr = dlsym(handle, "mlx_load_safetensors_reader");
    if (w_mlx_load_safetensors_reader_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_load_safetensors_reader\n");
        return -1;
    }
    w_mlx_load_safetensors_ptr = dlsym(handle, "mlx_load_safetensors");
    if (w_mlx_load_safetensors_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_load_safetensors\n");
        return -1;
    }
    w_mlx_save_writer_ptr = dlsym(handle, "mlx_save_writer");
    if (w_mlx_save_writer_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_save_writer\n");
        return -1;
    }
    w_mlx_save_ptr = dlsym(handle, "mlx_save");
    if (w_mlx_save_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_save\n");
        return -1;
    }
    w_mlx_save_safetensors_writer_ptr = dlsym(handle, "mlx_save_safetensors_writer");
    if (w_mlx_save_safetensors_writer_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_save_safetensors_writer\n");
        return -1;
    }
    w_mlx_save_safetensors_ptr = dlsym(handle, "mlx_save_safetensors");
    if (w_mlx_save_safetensors_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_save_safetensors\n");
        return -1;
    }
    w_mlx_dtype_size_ptr = dlsym(handle, "mlx_dtype_size");
    if (w_mlx_dtype_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_dtype_size\n");
        return -1;
    }
    w_mlx_array_tostring_ptr = dlsym(handle, "mlx_array_tostring");
    if (w_mlx_array_tostring_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_tostring\n");
        return -1;
    }
    w_mlx_array_new_ptr = dlsym(handle, "mlx_array_new");
    if (w_mlx_array_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new\n");
        return -1;
    }
    w_mlx_array_free_ptr = dlsym(handle, "mlx_array_free");
    if (w_mlx_array_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_free\n");
        return -1;
    }
    w_mlx_array_new_bool_ptr = dlsym(handle, "mlx_array_new_bool");
    if (w_mlx_array_new_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_bool\n");
        return -1;
    }
    w_mlx_array_new_int_ptr = dlsym(handle, "mlx_array_new_int");
    if (w_mlx_array_new_int_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_int\n");
        return -1;
    }
    w_mlx_array_new_float32_ptr = dlsym(handle, "mlx_array_new_float32");
    if (w_mlx_array_new_float32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_float32\n");
        return -1;
    }
    w_mlx_array_new_float_ptr = dlsym(handle, "mlx_array_new_float");
    if (w_mlx_array_new_float_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_float\n");
        return -1;
    }
    w_mlx_array_new_float64_ptr = dlsym(handle, "mlx_array_new_float64");
    if (w_mlx_array_new_float64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_float64\n");
        return -1;
    }
    w_mlx_array_new_double_ptr = dlsym(handle, "mlx_array_new_double");
    if (w_mlx_array_new_double_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_double\n");
        return -1;
    }
    w_mlx_array_new_complex_ptr = dlsym(handle, "mlx_array_new_complex");
    if (w_mlx_array_new_complex_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_complex\n");
        return -1;
    }
    w_mlx_array_new_data_ptr = dlsym(handle, "mlx_array_new_data");
    if (w_mlx_array_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_new_data\n");
        return -1;
    }
    w_mlx_array_set_ptr = dlsym(handle, "mlx_array_set");
    if (w_mlx_array_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set\n");
        return -1;
    }
    w_mlx_array_set_bool_ptr = dlsym(handle, "mlx_array_set_bool");
    if (w_mlx_array_set_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_bool\n");
        return -1;
    }
    w_mlx_array_set_int_ptr = dlsym(handle, "mlx_array_set_int");
    if (w_mlx_array_set_int_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_int\n");
        return -1;
    }
    w_mlx_array_set_float32_ptr = dlsym(handle, "mlx_array_set_float32");
    if (w_mlx_array_set_float32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_float32\n");
        return -1;
    }
    w_mlx_array_set_float_ptr = dlsym(handle, "mlx_array_set_float");
    if (w_mlx_array_set_float_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_float\n");
        return -1;
    }
    w_mlx_array_set_float64_ptr = dlsym(handle, "mlx_array_set_float64");
    if (w_mlx_array_set_float64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_float64\n");
        return -1;
    }
    w_mlx_array_set_double_ptr = dlsym(handle, "mlx_array_set_double");
    if (w_mlx_array_set_double_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_double\n");
        return -1;
    }
    w_mlx_array_set_complex_ptr = dlsym(handle, "mlx_array_set_complex");
    if (w_mlx_array_set_complex_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_complex\n");
        return -1;
    }
    w_mlx_array_set_data_ptr = dlsym(handle, "mlx_array_set_data");
    if (w_mlx_array_set_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_set_data\n");
        return -1;
    }
    w_mlx_array_itemsize_ptr = dlsym(handle, "mlx_array_itemsize");
    if (w_mlx_array_itemsize_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_itemsize\n");
        return -1;
    }
    w_mlx_array_size_ptr = dlsym(handle, "mlx_array_size");
    if (w_mlx_array_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_size\n");
        return -1;
    }
    w_mlx_array_nbytes_ptr = dlsym(handle, "mlx_array_nbytes");
    if (w_mlx_array_nbytes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_nbytes\n");
        return -1;
    }
    w_mlx_array_ndim_ptr = dlsym(handle, "mlx_array_ndim");
    if (w_mlx_array_ndim_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_ndim\n");
        return -1;
    }
    w_mlx_array_shape_ptr = dlsym(handle, "mlx_array_shape");
    if (w_mlx_array_shape_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_shape\n");
        return -1;
    }
    w_mlx_array_strides_ptr = dlsym(handle, "mlx_array_strides");
    if (w_mlx_array_strides_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_strides\n");
        return -1;
    }
    w_mlx_array_dim_ptr = dlsym(handle, "mlx_array_dim");
    if (w_mlx_array_dim_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_dim\n");
        return -1;
    }
    w_mlx_array_dtype_ptr = dlsym(handle, "mlx_array_dtype");
    if (w_mlx_array_dtype_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_dtype\n");
        return -1;
    }
    w_mlx_array_eval_ptr = dlsym(handle, "mlx_array_eval");
    if (w_mlx_array_eval_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_eval\n");
        return -1;
    }
    w_mlx_array_item_bool_ptr = dlsym(handle, "mlx_array_item_bool");
    if (w_mlx_array_item_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_bool\n");
        return -1;
    }
    w_mlx_array_item_uint8_ptr = dlsym(handle, "mlx_array_item_uint8");
    if (w_mlx_array_item_uint8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_uint8\n");
        return -1;
    }
    w_mlx_array_item_uint16_ptr = dlsym(handle, "mlx_array_item_uint16");
    if (w_mlx_array_item_uint16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_uint16\n");
        return -1;
    }
    w_mlx_array_item_uint32_ptr = dlsym(handle, "mlx_array_item_uint32");
    if (w_mlx_array_item_uint32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_uint32\n");
        return -1;
    }
    w_mlx_array_item_uint64_ptr = dlsym(handle, "mlx_array_item_uint64");
    if (w_mlx_array_item_uint64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_uint64\n");
        return -1;
    }
    w_mlx_array_item_int8_ptr = dlsym(handle, "mlx_array_item_int8");
    if (w_mlx_array_item_int8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_int8\n");
        return -1;
    }
    w_mlx_array_item_int16_ptr = dlsym(handle, "mlx_array_item_int16");
    if (w_mlx_array_item_int16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_int16\n");
        return -1;
    }
    w_mlx_array_item_int32_ptr = dlsym(handle, "mlx_array_item_int32");
    if (w_mlx_array_item_int32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_int32\n");
        return -1;
    }
    w_mlx_array_item_int64_ptr = dlsym(handle, "mlx_array_item_int64");
    if (w_mlx_array_item_int64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_int64\n");
        return -1;
    }
    w_mlx_array_item_float32_ptr = dlsym(handle, "mlx_array_item_float32");
    if (w_mlx_array_item_float32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_float32\n");
        return -1;
    }
    w_mlx_array_item_float64_ptr = dlsym(handle, "mlx_array_item_float64");
    if (w_mlx_array_item_float64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_float64\n");
        return -1;
    }
    w_mlx_array_item_complex64_ptr = dlsym(handle, "mlx_array_item_complex64");
    if (w_mlx_array_item_complex64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_complex64\n");
        return -1;
    }
#if defined(__aarch64__) || defined(_M_ARM64)
    w_mlx_array_item_float16_ptr = dlsym(handle, "mlx_array_item_float16");
    if (w_mlx_array_item_float16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_float16\n");
        return -1;
    }
#endif
#if defined(__aarch64__) || defined(_M_ARM64)
    w_mlx_array_item_bfloat16_ptr = dlsym(handle, "mlx_array_item_bfloat16");
    if (w_mlx_array_item_bfloat16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_item_bfloat16\n");
        return -1;
    }
#endif
    w_mlx_array_data_bool_ptr = dlsym(handle, "mlx_array_data_bool");
    if (w_mlx_array_data_bool_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_bool\n");
        return -1;
    }
    w_mlx_array_data_uint8_ptr = dlsym(handle, "mlx_array_data_uint8");
    if (w_mlx_array_data_uint8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_uint8\n");
        return -1;
    }
    w_mlx_array_data_uint16_ptr = dlsym(handle, "mlx_array_data_uint16");
    if (w_mlx_array_data_uint16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_uint16\n");
        return -1;
    }
    w_mlx_array_data_uint32_ptr = dlsym(handle, "mlx_array_data_uint32");
    if (w_mlx_array_data_uint32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_uint32\n");
        return -1;
    }
    w_mlx_array_data_uint64_ptr = dlsym(handle, "mlx_array_data_uint64");
    if (w_mlx_array_data_uint64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_uint64\n");
        return -1;
    }
    w_mlx_array_data_int8_ptr = dlsym(handle, "mlx_array_data_int8");
    if (w_mlx_array_data_int8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_int8\n");
        return -1;
    }
    w_mlx_array_data_int16_ptr = dlsym(handle, "mlx_array_data_int16");
    if (w_mlx_array_data_int16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_int16\n");
        return -1;
    }
    w_mlx_array_data_int32_ptr = dlsym(handle, "mlx_array_data_int32");
    if (w_mlx_array_data_int32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_int32\n");
        return -1;
    }
    w_mlx_array_data_int64_ptr = dlsym(handle, "mlx_array_data_int64");
    if (w_mlx_array_data_int64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_int64\n");
        return -1;
    }
    w_mlx_array_data_float32_ptr = dlsym(handle, "mlx_array_data_float32");
    if (w_mlx_array_data_float32_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_float32\n");
        return -1;
    }
    w_mlx_array_data_float64_ptr = dlsym(handle, "mlx_array_data_float64");
    if (w_mlx_array_data_float64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_float64\n");
        return -1;
    }
    w_mlx_array_data_complex64_ptr = dlsym(handle, "mlx_array_data_complex64");
    if (w_mlx_array_data_complex64_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_complex64\n");
        return -1;
    }
#if defined(__aarch64__) || defined(_M_ARM64)
    w_mlx_array_data_float16_ptr = dlsym(handle, "mlx_array_data_float16");
    if (w_mlx_array_data_float16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_float16\n");
        return -1;
    }
#endif
#if defined(__aarch64__) || defined(_M_ARM64)
    w_mlx_array_data_bfloat16_ptr = dlsym(handle, "mlx_array_data_bfloat16");
    if (w_mlx_array_data_bfloat16_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_data_bfloat16\n");
        return -1;
    }
#endif
    w__mlx_array_is_available_ptr = dlsym(handle, "_mlx_array_is_available");
    if (w__mlx_array_is_available_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_array_is_available\n");
        return -1;
    }
    w__mlx_array_wait_ptr = dlsym(handle, "_mlx_array_wait");
    if (w__mlx_array_wait_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_array_wait\n");
        return -1;
    }
    w__mlx_array_is_contiguous_ptr = dlsym(handle, "_mlx_array_is_contiguous");
    if (w__mlx_array_is_contiguous_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_array_is_contiguous\n");
        return -1;
    }
    w__mlx_array_is_row_contiguous_ptr = dlsym(handle, "_mlx_array_is_row_contiguous");
    if (w__mlx_array_is_row_contiguous_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_array_is_row_contiguous\n");
        return -1;
    }
    w__mlx_array_is_col_contiguous_ptr = dlsym(handle, "_mlx_array_is_col_contiguous");
    if (w__mlx_array_is_col_contiguous_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: _mlx_array_is_col_contiguous\n");
        return -1;
    }
    w_mlx_linalg_cholesky_ptr = dlsym(handle, "mlx_linalg_cholesky");
    if (w_mlx_linalg_cholesky_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_cholesky\n");
        return -1;
    }
    w_mlx_linalg_cholesky_inv_ptr = dlsym(handle, "mlx_linalg_cholesky_inv");
    if (w_mlx_linalg_cholesky_inv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_cholesky_inv\n");
        return -1;
    }
    w_mlx_linalg_cross_ptr = dlsym(handle, "mlx_linalg_cross");
    if (w_mlx_linalg_cross_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_cross\n");
        return -1;
    }
    w_mlx_linalg_eig_ptr = dlsym(handle, "mlx_linalg_eig");
    if (w_mlx_linalg_eig_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_eig\n");
        return -1;
    }
    w_mlx_linalg_eigh_ptr = dlsym(handle, "mlx_linalg_eigh");
    if (w_mlx_linalg_eigh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_eigh\n");
        return -1;
    }
    w_mlx_linalg_eigvals_ptr = dlsym(handle, "mlx_linalg_eigvals");
    if (w_mlx_linalg_eigvals_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_eigvals\n");
        return -1;
    }
    w_mlx_linalg_eigvalsh_ptr = dlsym(handle, "mlx_linalg_eigvalsh");
    if (w_mlx_linalg_eigvalsh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_eigvalsh\n");
        return -1;
    }
    w_mlx_linalg_inv_ptr = dlsym(handle, "mlx_linalg_inv");
    if (w_mlx_linalg_inv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_inv\n");
        return -1;
    }
    w_mlx_linalg_lu_ptr = dlsym(handle, "mlx_linalg_lu");
    if (w_mlx_linalg_lu_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_lu\n");
        return -1;
    }
    w_mlx_linalg_lu_factor_ptr = dlsym(handle, "mlx_linalg_lu_factor");
    if (w_mlx_linalg_lu_factor_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_lu_factor\n");
        return -1;
    }
    w_mlx_linalg_norm_ptr = dlsym(handle, "mlx_linalg_norm");
    if (w_mlx_linalg_norm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_norm\n");
        return -1;
    }
    w_mlx_linalg_norm_matrix_ptr = dlsym(handle, "mlx_linalg_norm_matrix");
    if (w_mlx_linalg_norm_matrix_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_norm_matrix\n");
        return -1;
    }
    w_mlx_linalg_norm_l2_ptr = dlsym(handle, "mlx_linalg_norm_l2");
    if (w_mlx_linalg_norm_l2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_norm_l2\n");
        return -1;
    }
    w_mlx_linalg_pinv_ptr = dlsym(handle, "mlx_linalg_pinv");
    if (w_mlx_linalg_pinv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_pinv\n");
        return -1;
    }
    w_mlx_linalg_qr_ptr = dlsym(handle, "mlx_linalg_qr");
    if (w_mlx_linalg_qr_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_qr\n");
        return -1;
    }
    w_mlx_linalg_solve_ptr = dlsym(handle, "mlx_linalg_solve");
    if (w_mlx_linalg_solve_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_solve\n");
        return -1;
    }
    w_mlx_linalg_solve_triangular_ptr = dlsym(handle, "mlx_linalg_solve_triangular");
    if (w_mlx_linalg_solve_triangular_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_solve_triangular\n");
        return -1;
    }
    w_mlx_linalg_svd_ptr = dlsym(handle, "mlx_linalg_svd");
    if (w_mlx_linalg_svd_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_svd\n");
        return -1;
    }
    w_mlx_linalg_tri_inv_ptr = dlsym(handle, "mlx_linalg_tri_inv");
    if (w_mlx_linalg_tri_inv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linalg_tri_inv\n");
        return -1;
    }
    w_mlx_clear_cache_ptr = dlsym(handle, "mlx_clear_cache");
    if (w_mlx_clear_cache_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_clear_cache\n");
        return -1;
    }
    w_mlx_get_active_memory_ptr = dlsym(handle, "mlx_get_active_memory");
    if (w_mlx_get_active_memory_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_active_memory\n");
        return -1;
    }
    w_mlx_get_cache_memory_ptr = dlsym(handle, "mlx_get_cache_memory");
    if (w_mlx_get_cache_memory_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_cache_memory\n");
        return -1;
    }
    w_mlx_get_memory_limit_ptr = dlsym(handle, "mlx_get_memory_limit");
    if (w_mlx_get_memory_limit_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_memory_limit\n");
        return -1;
    }
    w_mlx_get_peak_memory_ptr = dlsym(handle, "mlx_get_peak_memory");
    if (w_mlx_get_peak_memory_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_get_peak_memory\n");
        return -1;
    }
    w_mlx_reset_peak_memory_ptr = dlsym(handle, "mlx_reset_peak_memory");
    if (w_mlx_reset_peak_memory_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_reset_peak_memory\n");
        return -1;
    }
    w_mlx_set_cache_limit_ptr = dlsym(handle, "mlx_set_cache_limit");
    if (w_mlx_set_cache_limit_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_cache_limit\n");
        return -1;
    }
    w_mlx_set_memory_limit_ptr = dlsym(handle, "mlx_set_memory_limit");
    if (w_mlx_set_memory_limit_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_memory_limit\n");
        return -1;
    }
    w_mlx_set_wired_limit_ptr = dlsym(handle, "mlx_set_wired_limit");
    if (w_mlx_set_wired_limit_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_set_wired_limit\n");
        return -1;
    }
    w_mlx_closure_new_ptr = dlsym(handle, "mlx_closure_new");
    if (w_mlx_closure_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_new\n");
        return -1;
    }
    w_mlx_closure_free_ptr = dlsym(handle, "mlx_closure_free");
    if (w_mlx_closure_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_free\n");
        return -1;
    }
    w_mlx_closure_new_func_ptr = dlsym(handle, "mlx_closure_new_func");
    if (w_mlx_closure_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_new_func\n");
        return -1;
    }
    w_mlx_closure_new_func_payload_ptr = dlsym(handle, "mlx_closure_new_func_payload");
    if (w_mlx_closure_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_set_ptr = dlsym(handle, "mlx_closure_set");
    if (w_mlx_closure_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_set\n");
        return -1;
    }
    w_mlx_closure_apply_ptr = dlsym(handle, "mlx_closure_apply");
    if (w_mlx_closure_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_apply\n");
        return -1;
    }
    w_mlx_closure_new_unary_ptr = dlsym(handle, "mlx_closure_new_unary");
    if (w_mlx_closure_new_unary_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_new_unary\n");
        return -1;
    }
    w_mlx_closure_kwargs_new_ptr = dlsym(handle, "mlx_closure_kwargs_new");
    if (w_mlx_closure_kwargs_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_new\n");
        return -1;
    }
    w_mlx_closure_kwargs_free_ptr = dlsym(handle, "mlx_closure_kwargs_free");
    if (w_mlx_closure_kwargs_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_free\n");
        return -1;
    }
    w_mlx_closure_kwargs_new_func_ptr = dlsym(handle, "mlx_closure_kwargs_new_func");
    if (w_mlx_closure_kwargs_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_new_func\n");
        return -1;
    }
    w_mlx_closure_kwargs_new_func_payload_ptr = dlsym(handle, "mlx_closure_kwargs_new_func_payload");
    if (w_mlx_closure_kwargs_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_kwargs_set_ptr = dlsym(handle, "mlx_closure_kwargs_set");
    if (w_mlx_closure_kwargs_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_set\n");
        return -1;
    }
    w_mlx_closure_kwargs_apply_ptr = dlsym(handle, "mlx_closure_kwargs_apply");
    if (w_mlx_closure_kwargs_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_kwargs_apply\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_new_ptr = dlsym(handle, "mlx_closure_value_and_grad_new");
    if (w_mlx_closure_value_and_grad_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_new\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_free_ptr = dlsym(handle, "mlx_closure_value_and_grad_free");
    if (w_mlx_closure_value_and_grad_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_free\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_new_func_ptr = dlsym(handle, "mlx_closure_value_and_grad_new_func");
    if (w_mlx_closure_value_and_grad_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_new_func\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_new_func_payload_ptr = dlsym(handle, "mlx_closure_value_and_grad_new_func_payload");
    if (w_mlx_closure_value_and_grad_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_set_ptr = dlsym(handle, "mlx_closure_value_and_grad_set");
    if (w_mlx_closure_value_and_grad_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_set\n");
        return -1;
    }
    w_mlx_closure_value_and_grad_apply_ptr = dlsym(handle, "mlx_closure_value_and_grad_apply");
    if (w_mlx_closure_value_and_grad_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_value_and_grad_apply\n");
        return -1;
    }
    w_mlx_closure_custom_new_ptr = dlsym(handle, "mlx_closure_custom_new");
    if (w_mlx_closure_custom_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_new\n");
        return -1;
    }
    w_mlx_closure_custom_free_ptr = dlsym(handle, "mlx_closure_custom_free");
    if (w_mlx_closure_custom_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_free\n");
        return -1;
    }
    w_mlx_closure_custom_new_func_ptr = dlsym(handle, "mlx_closure_custom_new_func");
    if (w_mlx_closure_custom_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_new_func\n");
        return -1;
    }
    w_mlx_closure_custom_new_func_payload_ptr = dlsym(handle, "mlx_closure_custom_new_func_payload");
    if (w_mlx_closure_custom_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_custom_set_ptr = dlsym(handle, "mlx_closure_custom_set");
    if (w_mlx_closure_custom_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_set\n");
        return -1;
    }
    w_mlx_closure_custom_apply_ptr = dlsym(handle, "mlx_closure_custom_apply");
    if (w_mlx_closure_custom_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_apply\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_new_ptr = dlsym(handle, "mlx_closure_custom_jvp_new");
    if (w_mlx_closure_custom_jvp_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_new\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_free_ptr = dlsym(handle, "mlx_closure_custom_jvp_free");
    if (w_mlx_closure_custom_jvp_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_free\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_new_func_ptr = dlsym(handle, "mlx_closure_custom_jvp_new_func");
    if (w_mlx_closure_custom_jvp_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_new_func\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_new_func_payload_ptr = dlsym(handle, "mlx_closure_custom_jvp_new_func_payload");
    if (w_mlx_closure_custom_jvp_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_set_ptr = dlsym(handle, "mlx_closure_custom_jvp_set");
    if (w_mlx_closure_custom_jvp_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_set\n");
        return -1;
    }
    w_mlx_closure_custom_jvp_apply_ptr = dlsym(handle, "mlx_closure_custom_jvp_apply");
    if (w_mlx_closure_custom_jvp_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_jvp_apply\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_new_ptr = dlsym(handle, "mlx_closure_custom_vmap_new");
    if (w_mlx_closure_custom_vmap_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_new\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_free_ptr = dlsym(handle, "mlx_closure_custom_vmap_free");
    if (w_mlx_closure_custom_vmap_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_free\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_new_func_ptr = dlsym(handle, "mlx_closure_custom_vmap_new_func");
    if (w_mlx_closure_custom_vmap_new_func_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_new_func\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_new_func_payload_ptr = dlsym(handle, "mlx_closure_custom_vmap_new_func_payload");
    if (w_mlx_closure_custom_vmap_new_func_payload_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_new_func_payload\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_set_ptr = dlsym(handle, "mlx_closure_custom_vmap_set");
    if (w_mlx_closure_custom_vmap_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_set\n");
        return -1;
    }
    w_mlx_closure_custom_vmap_apply_ptr = dlsym(handle, "mlx_closure_custom_vmap_apply");
    if (w_mlx_closure_custom_vmap_apply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_closure_custom_vmap_apply\n");
        return -1;
    }
    w_mlx_abs_ptr = dlsym(handle, "mlx_abs");
    if (w_mlx_abs_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_abs\n");
        return -1;
    }
    w_mlx_add_ptr = dlsym(handle, "mlx_add");
    if (w_mlx_add_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_add\n");
        return -1;
    }
    w_mlx_addmm_ptr = dlsym(handle, "mlx_addmm");
    if (w_mlx_addmm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_addmm\n");
        return -1;
    }
    w_mlx_all_axes_ptr = dlsym(handle, "mlx_all_axes");
    if (w_mlx_all_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_all_axes\n");
        return -1;
    }
    w_mlx_all_axis_ptr = dlsym(handle, "mlx_all_axis");
    if (w_mlx_all_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_all_axis\n");
        return -1;
    }
    w_mlx_all_ptr = dlsym(handle, "mlx_all");
    if (w_mlx_all_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_all\n");
        return -1;
    }
    w_mlx_allclose_ptr = dlsym(handle, "mlx_allclose");
    if (w_mlx_allclose_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_allclose\n");
        return -1;
    }
    w_mlx_any_axes_ptr = dlsym(handle, "mlx_any_axes");
    if (w_mlx_any_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_any_axes\n");
        return -1;
    }
    w_mlx_any_axis_ptr = dlsym(handle, "mlx_any_axis");
    if (w_mlx_any_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_any_axis\n");
        return -1;
    }
    w_mlx_any_ptr = dlsym(handle, "mlx_any");
    if (w_mlx_any_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_any\n");
        return -1;
    }
    w_mlx_arange_ptr = dlsym(handle, "mlx_arange");
    if (w_mlx_arange_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arange\n");
        return -1;
    }
    w_mlx_arccos_ptr = dlsym(handle, "mlx_arccos");
    if (w_mlx_arccos_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arccos\n");
        return -1;
    }
    w_mlx_arccosh_ptr = dlsym(handle, "mlx_arccosh");
    if (w_mlx_arccosh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arccosh\n");
        return -1;
    }
    w_mlx_arcsin_ptr = dlsym(handle, "mlx_arcsin");
    if (w_mlx_arcsin_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arcsin\n");
        return -1;
    }
    w_mlx_arcsinh_ptr = dlsym(handle, "mlx_arcsinh");
    if (w_mlx_arcsinh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arcsinh\n");
        return -1;
    }
    w_mlx_arctan_ptr = dlsym(handle, "mlx_arctan");
    if (w_mlx_arctan_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arctan\n");
        return -1;
    }
    w_mlx_arctan2_ptr = dlsym(handle, "mlx_arctan2");
    if (w_mlx_arctan2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arctan2\n");
        return -1;
    }
    w_mlx_arctanh_ptr = dlsym(handle, "mlx_arctanh");
    if (w_mlx_arctanh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_arctanh\n");
        return -1;
    }
    w_mlx_argmax_axis_ptr = dlsym(handle, "mlx_argmax_axis");
    if (w_mlx_argmax_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argmax_axis\n");
        return -1;
    }
    w_mlx_argmax_ptr = dlsym(handle, "mlx_argmax");
    if (w_mlx_argmax_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argmax\n");
        return -1;
    }
    w_mlx_argmin_axis_ptr = dlsym(handle, "mlx_argmin_axis");
    if (w_mlx_argmin_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argmin_axis\n");
        return -1;
    }
    w_mlx_argmin_ptr = dlsym(handle, "mlx_argmin");
    if (w_mlx_argmin_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argmin\n");
        return -1;
    }
    w_mlx_argpartition_axis_ptr = dlsym(handle, "mlx_argpartition_axis");
    if (w_mlx_argpartition_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argpartition_axis\n");
        return -1;
    }
    w_mlx_argpartition_ptr = dlsym(handle, "mlx_argpartition");
    if (w_mlx_argpartition_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argpartition\n");
        return -1;
    }
    w_mlx_argsort_axis_ptr = dlsym(handle, "mlx_argsort_axis");
    if (w_mlx_argsort_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argsort_axis\n");
        return -1;
    }
    w_mlx_argsort_ptr = dlsym(handle, "mlx_argsort");
    if (w_mlx_argsort_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_argsort\n");
        return -1;
    }
    w_mlx_array_equal_ptr = dlsym(handle, "mlx_array_equal");
    if (w_mlx_array_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_array_equal\n");
        return -1;
    }
    w_mlx_as_strided_ptr = dlsym(handle, "mlx_as_strided");
    if (w_mlx_as_strided_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_as_strided\n");
        return -1;
    }
    w_mlx_astype_ptr = dlsym(handle, "mlx_astype");
    if (w_mlx_astype_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_astype\n");
        return -1;
    }
    w_mlx_atleast_1d_ptr = dlsym(handle, "mlx_atleast_1d");
    if (w_mlx_atleast_1d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_atleast_1d\n");
        return -1;
    }
    w_mlx_atleast_2d_ptr = dlsym(handle, "mlx_atleast_2d");
    if (w_mlx_atleast_2d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_atleast_2d\n");
        return -1;
    }
    w_mlx_atleast_3d_ptr = dlsym(handle, "mlx_atleast_3d");
    if (w_mlx_atleast_3d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_atleast_3d\n");
        return -1;
    }
    w_mlx_bitwise_and_ptr = dlsym(handle, "mlx_bitwise_and");
    if (w_mlx_bitwise_and_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_bitwise_and\n");
        return -1;
    }
    w_mlx_bitwise_invert_ptr = dlsym(handle, "mlx_bitwise_invert");
    if (w_mlx_bitwise_invert_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_bitwise_invert\n");
        return -1;
    }
    w_mlx_bitwise_or_ptr = dlsym(handle, "mlx_bitwise_or");
    if (w_mlx_bitwise_or_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_bitwise_or\n");
        return -1;
    }
    w_mlx_bitwise_xor_ptr = dlsym(handle, "mlx_bitwise_xor");
    if (w_mlx_bitwise_xor_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_bitwise_xor\n");
        return -1;
    }
    w_mlx_block_masked_mm_ptr = dlsym(handle, "mlx_block_masked_mm");
    if (w_mlx_block_masked_mm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_block_masked_mm\n");
        return -1;
    }
    w_mlx_broadcast_arrays_ptr = dlsym(handle, "mlx_broadcast_arrays");
    if (w_mlx_broadcast_arrays_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_broadcast_arrays\n");
        return -1;
    }
    w_mlx_broadcast_to_ptr = dlsym(handle, "mlx_broadcast_to");
    if (w_mlx_broadcast_to_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_broadcast_to\n");
        return -1;
    }
    w_mlx_ceil_ptr = dlsym(handle, "mlx_ceil");
    if (w_mlx_ceil_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_ceil\n");
        return -1;
    }
    w_mlx_clip_ptr = dlsym(handle, "mlx_clip");
    if (w_mlx_clip_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_clip\n");
        return -1;
    }
    w_mlx_concatenate_axis_ptr = dlsym(handle, "mlx_concatenate_axis");
    if (w_mlx_concatenate_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_concatenate_axis\n");
        return -1;
    }
    w_mlx_concatenate_ptr = dlsym(handle, "mlx_concatenate");
    if (w_mlx_concatenate_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_concatenate\n");
        return -1;
    }
    w_mlx_conjugate_ptr = dlsym(handle, "mlx_conjugate");
    if (w_mlx_conjugate_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conjugate\n");
        return -1;
    }
    w_mlx_contiguous_ptr = dlsym(handle, "mlx_contiguous");
    if (w_mlx_contiguous_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_contiguous\n");
        return -1;
    }
    w_mlx_conv1d_ptr = dlsym(handle, "mlx_conv1d");
    if (w_mlx_conv1d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv1d\n");
        return -1;
    }
    w_mlx_conv2d_ptr = dlsym(handle, "mlx_conv2d");
    if (w_mlx_conv2d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv2d\n");
        return -1;
    }
    w_mlx_conv3d_ptr = dlsym(handle, "mlx_conv3d");
    if (w_mlx_conv3d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv3d\n");
        return -1;
    }
    w_mlx_conv_general_ptr = dlsym(handle, "mlx_conv_general");
    if (w_mlx_conv_general_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv_general\n");
        return -1;
    }
    w_mlx_conv_transpose1d_ptr = dlsym(handle, "mlx_conv_transpose1d");
    if (w_mlx_conv_transpose1d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv_transpose1d\n");
        return -1;
    }
    w_mlx_conv_transpose2d_ptr = dlsym(handle, "mlx_conv_transpose2d");
    if (w_mlx_conv_transpose2d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv_transpose2d\n");
        return -1;
    }
    w_mlx_conv_transpose3d_ptr = dlsym(handle, "mlx_conv_transpose3d");
    if (w_mlx_conv_transpose3d_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_conv_transpose3d\n");
        return -1;
    }
    w_mlx_copy_ptr = dlsym(handle, "mlx_copy");
    if (w_mlx_copy_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_copy\n");
        return -1;
    }
    w_mlx_cos_ptr = dlsym(handle, "mlx_cos");
    if (w_mlx_cos_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cos\n");
        return -1;
    }
    w_mlx_cosh_ptr = dlsym(handle, "mlx_cosh");
    if (w_mlx_cosh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cosh\n");
        return -1;
    }
    w_mlx_cummax_ptr = dlsym(handle, "mlx_cummax");
    if (w_mlx_cummax_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cummax\n");
        return -1;
    }
    w_mlx_cummin_ptr = dlsym(handle, "mlx_cummin");
    if (w_mlx_cummin_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cummin\n");
        return -1;
    }
    w_mlx_cumprod_ptr = dlsym(handle, "mlx_cumprod");
    if (w_mlx_cumprod_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cumprod\n");
        return -1;
    }
    w_mlx_cumsum_ptr = dlsym(handle, "mlx_cumsum");
    if (w_mlx_cumsum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_cumsum\n");
        return -1;
    }
    w_mlx_degrees_ptr = dlsym(handle, "mlx_degrees");
    if (w_mlx_degrees_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_degrees\n");
        return -1;
    }
    w_mlx_depends_ptr = dlsym(handle, "mlx_depends");
    if (w_mlx_depends_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_depends\n");
        return -1;
    }
    w_mlx_dequantize_ptr = dlsym(handle, "mlx_dequantize");
    if (w_mlx_dequantize_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_dequantize\n");
        return -1;
    }
    w_mlx_diag_ptr = dlsym(handle, "mlx_diag");
    if (w_mlx_diag_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_diag\n");
        return -1;
    }
    w_mlx_diagonal_ptr = dlsym(handle, "mlx_diagonal");
    if (w_mlx_diagonal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_diagonal\n");
        return -1;
    }
    w_mlx_divide_ptr = dlsym(handle, "mlx_divide");
    if (w_mlx_divide_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_divide\n");
        return -1;
    }
    w_mlx_divmod_ptr = dlsym(handle, "mlx_divmod");
    if (w_mlx_divmod_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_divmod\n");
        return -1;
    }
    w_mlx_einsum_ptr = dlsym(handle, "mlx_einsum");
    if (w_mlx_einsum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_einsum\n");
        return -1;
    }
    w_mlx_equal_ptr = dlsym(handle, "mlx_equal");
    if (w_mlx_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_equal\n");
        return -1;
    }
    w_mlx_erf_ptr = dlsym(handle, "mlx_erf");
    if (w_mlx_erf_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_erf\n");
        return -1;
    }
    w_mlx_erfinv_ptr = dlsym(handle, "mlx_erfinv");
    if (w_mlx_erfinv_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_erfinv\n");
        return -1;
    }
    w_mlx_exp_ptr = dlsym(handle, "mlx_exp");
    if (w_mlx_exp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_exp\n");
        return -1;
    }
    w_mlx_expand_dims_axes_ptr = dlsym(handle, "mlx_expand_dims_axes");
    if (w_mlx_expand_dims_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_expand_dims_axes\n");
        return -1;
    }
    w_mlx_expand_dims_ptr = dlsym(handle, "mlx_expand_dims");
    if (w_mlx_expand_dims_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_expand_dims\n");
        return -1;
    }
    w_mlx_expm1_ptr = dlsym(handle, "mlx_expm1");
    if (w_mlx_expm1_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_expm1\n");
        return -1;
    }
    w_mlx_eye_ptr = dlsym(handle, "mlx_eye");
    if (w_mlx_eye_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_eye\n");
        return -1;
    }
    w_mlx_flatten_ptr = dlsym(handle, "mlx_flatten");
    if (w_mlx_flatten_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_flatten\n");
        return -1;
    }
    w_mlx_floor_ptr = dlsym(handle, "mlx_floor");
    if (w_mlx_floor_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_floor\n");
        return -1;
    }
    w_mlx_floor_divide_ptr = dlsym(handle, "mlx_floor_divide");
    if (w_mlx_floor_divide_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_floor_divide\n");
        return -1;
    }
    w_mlx_from_fp8_ptr = dlsym(handle, "mlx_from_fp8");
    if (w_mlx_from_fp8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_from_fp8\n");
        return -1;
    }
    w_mlx_full_ptr = dlsym(handle, "mlx_full");
    if (w_mlx_full_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_full\n");
        return -1;
    }
    w_mlx_full_like_ptr = dlsym(handle, "mlx_full_like");
    if (w_mlx_full_like_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_full_like\n");
        return -1;
    }
    w_mlx_gather_ptr = dlsym(handle, "mlx_gather");
    if (w_mlx_gather_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_gather\n");
        return -1;
    }
    w_mlx_gather_single_ptr = dlsym(handle, "mlx_gather_single");
    if (w_mlx_gather_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_gather_single\n");
        return -1;
    }
    w_mlx_gather_mm_ptr = dlsym(handle, "mlx_gather_mm");
    if (w_mlx_gather_mm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_gather_mm\n");
        return -1;
    }
    w_mlx_gather_qmm_ptr = dlsym(handle, "mlx_gather_qmm");
    if (w_mlx_gather_qmm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_gather_qmm\n");
        return -1;
    }
    w_mlx_greater_ptr = dlsym(handle, "mlx_greater");
    if (w_mlx_greater_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_greater\n");
        return -1;
    }
    w_mlx_greater_equal_ptr = dlsym(handle, "mlx_greater_equal");
    if (w_mlx_greater_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_greater_equal\n");
        return -1;
    }
    w_mlx_hadamard_transform_ptr = dlsym(handle, "mlx_hadamard_transform");
    if (w_mlx_hadamard_transform_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_hadamard_transform\n");
        return -1;
    }
    w_mlx_identity_ptr = dlsym(handle, "mlx_identity");
    if (w_mlx_identity_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_identity\n");
        return -1;
    }
    w_mlx_imag_ptr = dlsym(handle, "mlx_imag");
    if (w_mlx_imag_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_imag\n");
        return -1;
    }
    w_mlx_inner_ptr = dlsym(handle, "mlx_inner");
    if (w_mlx_inner_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_inner\n");
        return -1;
    }
    w_mlx_isclose_ptr = dlsym(handle, "mlx_isclose");
    if (w_mlx_isclose_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isclose\n");
        return -1;
    }
    w_mlx_isfinite_ptr = dlsym(handle, "mlx_isfinite");
    if (w_mlx_isfinite_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isfinite\n");
        return -1;
    }
    w_mlx_isinf_ptr = dlsym(handle, "mlx_isinf");
    if (w_mlx_isinf_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isinf\n");
        return -1;
    }
    w_mlx_isnan_ptr = dlsym(handle, "mlx_isnan");
    if (w_mlx_isnan_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isnan\n");
        return -1;
    }
    w_mlx_isneginf_ptr = dlsym(handle, "mlx_isneginf");
    if (w_mlx_isneginf_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isneginf\n");
        return -1;
    }
    w_mlx_isposinf_ptr = dlsym(handle, "mlx_isposinf");
    if (w_mlx_isposinf_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_isposinf\n");
        return -1;
    }
    w_mlx_kron_ptr = dlsym(handle, "mlx_kron");
    if (w_mlx_kron_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_kron\n");
        return -1;
    }
    w_mlx_left_shift_ptr = dlsym(handle, "mlx_left_shift");
    if (w_mlx_left_shift_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_left_shift\n");
        return -1;
    }
    w_mlx_less_ptr = dlsym(handle, "mlx_less");
    if (w_mlx_less_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_less\n");
        return -1;
    }
    w_mlx_less_equal_ptr = dlsym(handle, "mlx_less_equal");
    if (w_mlx_less_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_less_equal\n");
        return -1;
    }
    w_mlx_linspace_ptr = dlsym(handle, "mlx_linspace");
    if (w_mlx_linspace_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_linspace\n");
        return -1;
    }
    w_mlx_log_ptr = dlsym(handle, "mlx_log");
    if (w_mlx_log_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_log\n");
        return -1;
    }
    w_mlx_log10_ptr = dlsym(handle, "mlx_log10");
    if (w_mlx_log10_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_log10\n");
        return -1;
    }
    w_mlx_log1p_ptr = dlsym(handle, "mlx_log1p");
    if (w_mlx_log1p_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_log1p\n");
        return -1;
    }
    w_mlx_log2_ptr = dlsym(handle, "mlx_log2");
    if (w_mlx_log2_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_log2\n");
        return -1;
    }
    w_mlx_logaddexp_ptr = dlsym(handle, "mlx_logaddexp");
    if (w_mlx_logaddexp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logaddexp\n");
        return -1;
    }
    w_mlx_logcumsumexp_ptr = dlsym(handle, "mlx_logcumsumexp");
    if (w_mlx_logcumsumexp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logcumsumexp\n");
        return -1;
    }
    w_mlx_logical_and_ptr = dlsym(handle, "mlx_logical_and");
    if (w_mlx_logical_and_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logical_and\n");
        return -1;
    }
    w_mlx_logical_not_ptr = dlsym(handle, "mlx_logical_not");
    if (w_mlx_logical_not_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logical_not\n");
        return -1;
    }
    w_mlx_logical_or_ptr = dlsym(handle, "mlx_logical_or");
    if (w_mlx_logical_or_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logical_or\n");
        return -1;
    }
    w_mlx_logsumexp_axes_ptr = dlsym(handle, "mlx_logsumexp_axes");
    if (w_mlx_logsumexp_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logsumexp_axes\n");
        return -1;
    }
    w_mlx_logsumexp_axis_ptr = dlsym(handle, "mlx_logsumexp_axis");
    if (w_mlx_logsumexp_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logsumexp_axis\n");
        return -1;
    }
    w_mlx_logsumexp_ptr = dlsym(handle, "mlx_logsumexp");
    if (w_mlx_logsumexp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_logsumexp\n");
        return -1;
    }
    w_mlx_masked_scatter_ptr = dlsym(handle, "mlx_masked_scatter");
    if (w_mlx_masked_scatter_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_masked_scatter\n");
        return -1;
    }
    w_mlx_matmul_ptr = dlsym(handle, "mlx_matmul");
    if (w_mlx_matmul_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_matmul\n");
        return -1;
    }
    w_mlx_max_axes_ptr = dlsym(handle, "mlx_max_axes");
    if (w_mlx_max_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_max_axes\n");
        return -1;
    }
    w_mlx_max_axis_ptr = dlsym(handle, "mlx_max_axis");
    if (w_mlx_max_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_max_axis\n");
        return -1;
    }
    w_mlx_max_ptr = dlsym(handle, "mlx_max");
    if (w_mlx_max_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_max\n");
        return -1;
    }
    w_mlx_maximum_ptr = dlsym(handle, "mlx_maximum");
    if (w_mlx_maximum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_maximum\n");
        return -1;
    }
    w_mlx_mean_axes_ptr = dlsym(handle, "mlx_mean_axes");
    if (w_mlx_mean_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_mean_axes\n");
        return -1;
    }
    w_mlx_mean_axis_ptr = dlsym(handle, "mlx_mean_axis");
    if (w_mlx_mean_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_mean_axis\n");
        return -1;
    }
    w_mlx_mean_ptr = dlsym(handle, "mlx_mean");
    if (w_mlx_mean_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_mean\n");
        return -1;
    }
    w_mlx_median_ptr = dlsym(handle, "mlx_median");
    if (w_mlx_median_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_median\n");
        return -1;
    }
    w_mlx_meshgrid_ptr = dlsym(handle, "mlx_meshgrid");
    if (w_mlx_meshgrid_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_meshgrid\n");
        return -1;
    }
    w_mlx_min_axes_ptr = dlsym(handle, "mlx_min_axes");
    if (w_mlx_min_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_min_axes\n");
        return -1;
    }
    w_mlx_min_axis_ptr = dlsym(handle, "mlx_min_axis");
    if (w_mlx_min_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_min_axis\n");
        return -1;
    }
    w_mlx_min_ptr = dlsym(handle, "mlx_min");
    if (w_mlx_min_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_min\n");
        return -1;
    }
    w_mlx_minimum_ptr = dlsym(handle, "mlx_minimum");
    if (w_mlx_minimum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_minimum\n");
        return -1;
    }
    w_mlx_moveaxis_ptr = dlsym(handle, "mlx_moveaxis");
    if (w_mlx_moveaxis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_moveaxis\n");
        return -1;
    }
    w_mlx_multiply_ptr = dlsym(handle, "mlx_multiply");
    if (w_mlx_multiply_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_multiply\n");
        return -1;
    }
    w_mlx_nan_to_num_ptr = dlsym(handle, "mlx_nan_to_num");
    if (w_mlx_nan_to_num_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_nan_to_num\n");
        return -1;
    }
    w_mlx_negative_ptr = dlsym(handle, "mlx_negative");
    if (w_mlx_negative_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_negative\n");
        return -1;
    }
    w_mlx_not_equal_ptr = dlsym(handle, "mlx_not_equal");
    if (w_mlx_not_equal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_not_equal\n");
        return -1;
    }
    w_mlx_number_of_elements_ptr = dlsym(handle, "mlx_number_of_elements");
    if (w_mlx_number_of_elements_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_number_of_elements\n");
        return -1;
    }
    w_mlx_ones_ptr = dlsym(handle, "mlx_ones");
    if (w_mlx_ones_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_ones\n");
        return -1;
    }
    w_mlx_ones_like_ptr = dlsym(handle, "mlx_ones_like");
    if (w_mlx_ones_like_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_ones_like\n");
        return -1;
    }
    w_mlx_outer_ptr = dlsym(handle, "mlx_outer");
    if (w_mlx_outer_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_outer\n");
        return -1;
    }
    w_mlx_pad_ptr = dlsym(handle, "mlx_pad");
    if (w_mlx_pad_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_pad\n");
        return -1;
    }
    w_mlx_pad_symmetric_ptr = dlsym(handle, "mlx_pad_symmetric");
    if (w_mlx_pad_symmetric_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_pad_symmetric\n");
        return -1;
    }
    w_mlx_partition_axis_ptr = dlsym(handle, "mlx_partition_axis");
    if (w_mlx_partition_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_partition_axis\n");
        return -1;
    }
    w_mlx_partition_ptr = dlsym(handle, "mlx_partition");
    if (w_mlx_partition_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_partition\n");
        return -1;
    }
    w_mlx_power_ptr = dlsym(handle, "mlx_power");
    if (w_mlx_power_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_power\n");
        return -1;
    }
    w_mlx_prod_axes_ptr = dlsym(handle, "mlx_prod_axes");
    if (w_mlx_prod_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_prod_axes\n");
        return -1;
    }
    w_mlx_prod_axis_ptr = dlsym(handle, "mlx_prod_axis");
    if (w_mlx_prod_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_prod_axis\n");
        return -1;
    }
    w_mlx_prod_ptr = dlsym(handle, "mlx_prod");
    if (w_mlx_prod_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_prod\n");
        return -1;
    }
    w_mlx_put_along_axis_ptr = dlsym(handle, "mlx_put_along_axis");
    if (w_mlx_put_along_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_put_along_axis\n");
        return -1;
    }
    w_mlx_qqmm_ptr = dlsym(handle, "mlx_qqmm");
    if (w_mlx_qqmm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_qqmm\n");
        return -1;
    }
    w_mlx_quantize_ptr = dlsym(handle, "mlx_quantize");
    if (w_mlx_quantize_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_quantize\n");
        return -1;
    }
    w_mlx_quantized_matmul_ptr = dlsym(handle, "mlx_quantized_matmul");
    if (w_mlx_quantized_matmul_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_quantized_matmul\n");
        return -1;
    }
    w_mlx_radians_ptr = dlsym(handle, "mlx_radians");
    if (w_mlx_radians_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_radians\n");
        return -1;
    }
    w_mlx_real_ptr = dlsym(handle, "mlx_real");
    if (w_mlx_real_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_real\n");
        return -1;
    }
    w_mlx_reciprocal_ptr = dlsym(handle, "mlx_reciprocal");
    if (w_mlx_reciprocal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_reciprocal\n");
        return -1;
    }
    w_mlx_remainder_ptr = dlsym(handle, "mlx_remainder");
    if (w_mlx_remainder_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_remainder\n");
        return -1;
    }
    w_mlx_repeat_axis_ptr = dlsym(handle, "mlx_repeat_axis");
    if (w_mlx_repeat_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_repeat_axis\n");
        return -1;
    }
    w_mlx_repeat_ptr = dlsym(handle, "mlx_repeat");
    if (w_mlx_repeat_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_repeat\n");
        return -1;
    }
    w_mlx_reshape_ptr = dlsym(handle, "mlx_reshape");
    if (w_mlx_reshape_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_reshape\n");
        return -1;
    }
    w_mlx_right_shift_ptr = dlsym(handle, "mlx_right_shift");
    if (w_mlx_right_shift_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_right_shift\n");
        return -1;
    }
    w_mlx_roll_axis_ptr = dlsym(handle, "mlx_roll_axis");
    if (w_mlx_roll_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_roll_axis\n");
        return -1;
    }
    w_mlx_roll_axes_ptr = dlsym(handle, "mlx_roll_axes");
    if (w_mlx_roll_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_roll_axes\n");
        return -1;
    }
    w_mlx_roll_ptr = dlsym(handle, "mlx_roll");
    if (w_mlx_roll_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_roll\n");
        return -1;
    }
    w_mlx_round_ptr = dlsym(handle, "mlx_round");
    if (w_mlx_round_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_round\n");
        return -1;
    }
    w_mlx_rsqrt_ptr = dlsym(handle, "mlx_rsqrt");
    if (w_mlx_rsqrt_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_rsqrt\n");
        return -1;
    }
    w_mlx_scatter_ptr = dlsym(handle, "mlx_scatter");
    if (w_mlx_scatter_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter\n");
        return -1;
    }
    w_mlx_scatter_single_ptr = dlsym(handle, "mlx_scatter_single");
    if (w_mlx_scatter_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_single\n");
        return -1;
    }
    w_mlx_scatter_add_ptr = dlsym(handle, "mlx_scatter_add");
    if (w_mlx_scatter_add_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_add\n");
        return -1;
    }
    w_mlx_scatter_add_single_ptr = dlsym(handle, "mlx_scatter_add_single");
    if (w_mlx_scatter_add_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_add_single\n");
        return -1;
    }
    w_mlx_scatter_add_axis_ptr = dlsym(handle, "mlx_scatter_add_axis");
    if (w_mlx_scatter_add_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_add_axis\n");
        return -1;
    }
    w_mlx_scatter_max_ptr = dlsym(handle, "mlx_scatter_max");
    if (w_mlx_scatter_max_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_max\n");
        return -1;
    }
    w_mlx_scatter_max_single_ptr = dlsym(handle, "mlx_scatter_max_single");
    if (w_mlx_scatter_max_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_max_single\n");
        return -1;
    }
    w_mlx_scatter_min_ptr = dlsym(handle, "mlx_scatter_min");
    if (w_mlx_scatter_min_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_min\n");
        return -1;
    }
    w_mlx_scatter_min_single_ptr = dlsym(handle, "mlx_scatter_min_single");
    if (w_mlx_scatter_min_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_min_single\n");
        return -1;
    }
    w_mlx_scatter_prod_ptr = dlsym(handle, "mlx_scatter_prod");
    if (w_mlx_scatter_prod_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_prod\n");
        return -1;
    }
    w_mlx_scatter_prod_single_ptr = dlsym(handle, "mlx_scatter_prod_single");
    if (w_mlx_scatter_prod_single_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_scatter_prod_single\n");
        return -1;
    }
    w_mlx_segmented_mm_ptr = dlsym(handle, "mlx_segmented_mm");
    if (w_mlx_segmented_mm_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_segmented_mm\n");
        return -1;
    }
    w_mlx_sigmoid_ptr = dlsym(handle, "mlx_sigmoid");
    if (w_mlx_sigmoid_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sigmoid\n");
        return -1;
    }
    w_mlx_sign_ptr = dlsym(handle, "mlx_sign");
    if (w_mlx_sign_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sign\n");
        return -1;
    }
    w_mlx_sin_ptr = dlsym(handle, "mlx_sin");
    if (w_mlx_sin_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sin\n");
        return -1;
    }
    w_mlx_sinh_ptr = dlsym(handle, "mlx_sinh");
    if (w_mlx_sinh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sinh\n");
        return -1;
    }
    w_mlx_slice_ptr = dlsym(handle, "mlx_slice");
    if (w_mlx_slice_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_slice\n");
        return -1;
    }
    w_mlx_slice_dynamic_ptr = dlsym(handle, "mlx_slice_dynamic");
    if (w_mlx_slice_dynamic_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_slice_dynamic\n");
        return -1;
    }
    w_mlx_slice_update_ptr = dlsym(handle, "mlx_slice_update");
    if (w_mlx_slice_update_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_slice_update\n");
        return -1;
    }
    w_mlx_slice_update_dynamic_ptr = dlsym(handle, "mlx_slice_update_dynamic");
    if (w_mlx_slice_update_dynamic_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_slice_update_dynamic\n");
        return -1;
    }
    w_mlx_softmax_axes_ptr = dlsym(handle, "mlx_softmax_axes");
    if (w_mlx_softmax_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_softmax_axes\n");
        return -1;
    }
    w_mlx_softmax_axis_ptr = dlsym(handle, "mlx_softmax_axis");
    if (w_mlx_softmax_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_softmax_axis\n");
        return -1;
    }
    w_mlx_softmax_ptr = dlsym(handle, "mlx_softmax");
    if (w_mlx_softmax_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_softmax\n");
        return -1;
    }
    w_mlx_sort_axis_ptr = dlsym(handle, "mlx_sort_axis");
    if (w_mlx_sort_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sort_axis\n");
        return -1;
    }
    w_mlx_sort_ptr = dlsym(handle, "mlx_sort");
    if (w_mlx_sort_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sort\n");
        return -1;
    }
    w_mlx_split_ptr = dlsym(handle, "mlx_split");
    if (w_mlx_split_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_split\n");
        return -1;
    }
    w_mlx_split_sections_ptr = dlsym(handle, "mlx_split_sections");
    if (w_mlx_split_sections_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_split_sections\n");
        return -1;
    }
    w_mlx_sqrt_ptr = dlsym(handle, "mlx_sqrt");
    if (w_mlx_sqrt_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sqrt\n");
        return -1;
    }
    w_mlx_square_ptr = dlsym(handle, "mlx_square");
    if (w_mlx_square_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_square\n");
        return -1;
    }
    w_mlx_squeeze_axes_ptr = dlsym(handle, "mlx_squeeze_axes");
    if (w_mlx_squeeze_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_squeeze_axes\n");
        return -1;
    }
    w_mlx_squeeze_axis_ptr = dlsym(handle, "mlx_squeeze_axis");
    if (w_mlx_squeeze_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_squeeze_axis\n");
        return -1;
    }
    w_mlx_squeeze_ptr = dlsym(handle, "mlx_squeeze");
    if (w_mlx_squeeze_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_squeeze\n");
        return -1;
    }
    w_mlx_stack_axis_ptr = dlsym(handle, "mlx_stack_axis");
    if (w_mlx_stack_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stack_axis\n");
        return -1;
    }
    w_mlx_stack_ptr = dlsym(handle, "mlx_stack");
    if (w_mlx_stack_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stack\n");
        return -1;
    }
    w_mlx_std_axes_ptr = dlsym(handle, "mlx_std_axes");
    if (w_mlx_std_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_std_axes\n");
        return -1;
    }
    w_mlx_std_axis_ptr = dlsym(handle, "mlx_std_axis");
    if (w_mlx_std_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_std_axis\n");
        return -1;
    }
    w_mlx_std_ptr = dlsym(handle, "mlx_std");
    if (w_mlx_std_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_std\n");
        return -1;
    }
    w_mlx_stop_gradient_ptr = dlsym(handle, "mlx_stop_gradient");
    if (w_mlx_stop_gradient_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_stop_gradient\n");
        return -1;
    }
    w_mlx_subtract_ptr = dlsym(handle, "mlx_subtract");
    if (w_mlx_subtract_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_subtract\n");
        return -1;
    }
    w_mlx_sum_axes_ptr = dlsym(handle, "mlx_sum_axes");
    if (w_mlx_sum_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sum_axes\n");
        return -1;
    }
    w_mlx_sum_axis_ptr = dlsym(handle, "mlx_sum_axis");
    if (w_mlx_sum_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sum_axis\n");
        return -1;
    }
    w_mlx_sum_ptr = dlsym(handle, "mlx_sum");
    if (w_mlx_sum_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_sum\n");
        return -1;
    }
    w_mlx_swapaxes_ptr = dlsym(handle, "mlx_swapaxes");
    if (w_mlx_swapaxes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_swapaxes\n");
        return -1;
    }
    w_mlx_take_axis_ptr = dlsym(handle, "mlx_take_axis");
    if (w_mlx_take_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_take_axis\n");
        return -1;
    }
    w_mlx_take_ptr = dlsym(handle, "mlx_take");
    if (w_mlx_take_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_take\n");
        return -1;
    }
    w_mlx_take_along_axis_ptr = dlsym(handle, "mlx_take_along_axis");
    if (w_mlx_take_along_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_take_along_axis\n");
        return -1;
    }
    w_mlx_tan_ptr = dlsym(handle, "mlx_tan");
    if (w_mlx_tan_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tan\n");
        return -1;
    }
    w_mlx_tanh_ptr = dlsym(handle, "mlx_tanh");
    if (w_mlx_tanh_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tanh\n");
        return -1;
    }
    w_mlx_tensordot_ptr = dlsym(handle, "mlx_tensordot");
    if (w_mlx_tensordot_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tensordot\n");
        return -1;
    }
    w_mlx_tensordot_axis_ptr = dlsym(handle, "mlx_tensordot_axis");
    if (w_mlx_tensordot_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tensordot_axis\n");
        return -1;
    }
    w_mlx_tile_ptr = dlsym(handle, "mlx_tile");
    if (w_mlx_tile_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tile\n");
        return -1;
    }
    w_mlx_to_fp8_ptr = dlsym(handle, "mlx_to_fp8");
    if (w_mlx_to_fp8_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_to_fp8\n");
        return -1;
    }
    w_mlx_topk_axis_ptr = dlsym(handle, "mlx_topk_axis");
    if (w_mlx_topk_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_topk_axis\n");
        return -1;
    }
    w_mlx_topk_ptr = dlsym(handle, "mlx_topk");
    if (w_mlx_topk_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_topk\n");
        return -1;
    }
    w_mlx_trace_ptr = dlsym(handle, "mlx_trace");
    if (w_mlx_trace_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_trace\n");
        return -1;
    }
    w_mlx_transpose_axes_ptr = dlsym(handle, "mlx_transpose_axes");
    if (w_mlx_transpose_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_transpose_axes\n");
        return -1;
    }
    w_mlx_transpose_ptr = dlsym(handle, "mlx_transpose");
    if (w_mlx_transpose_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_transpose\n");
        return -1;
    }
    w_mlx_tri_ptr = dlsym(handle, "mlx_tri");
    if (w_mlx_tri_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tri\n");
        return -1;
    }
    w_mlx_tril_ptr = dlsym(handle, "mlx_tril");
    if (w_mlx_tril_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_tril\n");
        return -1;
    }
    w_mlx_triu_ptr = dlsym(handle, "mlx_triu");
    if (w_mlx_triu_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_triu\n");
        return -1;
    }
    w_mlx_unflatten_ptr = dlsym(handle, "mlx_unflatten");
    if (w_mlx_unflatten_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_unflatten\n");
        return -1;
    }
    w_mlx_var_axes_ptr = dlsym(handle, "mlx_var_axes");
    if (w_mlx_var_axes_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_var_axes\n");
        return -1;
    }
    w_mlx_var_axis_ptr = dlsym(handle, "mlx_var_axis");
    if (w_mlx_var_axis_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_var_axis\n");
        return -1;
    }
    w_mlx_var_ptr = dlsym(handle, "mlx_var");
    if (w_mlx_var_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_var\n");
        return -1;
    }
    w_mlx_view_ptr = dlsym(handle, "mlx_view");
    if (w_mlx_view_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_view\n");
        return -1;
    }
    w_mlx_where_ptr = dlsym(handle, "mlx_where");
    if (w_mlx_where_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_where\n");
        return -1;
    }
    w_mlx_zeros_ptr = dlsym(handle, "mlx_zeros");
    if (w_mlx_zeros_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_zeros\n");
        return -1;
    }
    w_mlx_zeros_like_ptr = dlsym(handle, "mlx_zeros_like");
    if (w_mlx_zeros_like_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_zeros_like\n");
        return -1;
    }
    w_mlx_metal_device_info_ptr = dlsym(handle, "mlx_metal_device_info");
    if (w_mlx_metal_device_info_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_metal_device_info\n");
        return -1;
    }
    w_mlx_metal_is_available_ptr = dlsym(handle, "mlx_metal_is_available");
    if (w_mlx_metal_is_available_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_metal_is_available\n");
        return -1;
    }
    w_mlx_metal_start_capture_ptr = dlsym(handle, "mlx_metal_start_capture");
    if (w_mlx_metal_start_capture_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_metal_start_capture\n");
        return -1;
    }
    w_mlx_metal_stop_capture_ptr = dlsym(handle, "mlx_metal_stop_capture");
    if (w_mlx_metal_stop_capture_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_metal_stop_capture\n");
        return -1;
    }
    w_mlx_vector_array_new_ptr = dlsym(handle, "mlx_vector_array_new");
    if (w_mlx_vector_array_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_new\n");
        return -1;
    }
    w_mlx_vector_array_set_ptr = dlsym(handle, "mlx_vector_array_set");
    if (w_mlx_vector_array_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_set\n");
        return -1;
    }
    w_mlx_vector_array_free_ptr = dlsym(handle, "mlx_vector_array_free");
    if (w_mlx_vector_array_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_free\n");
        return -1;
    }
    w_mlx_vector_array_new_data_ptr = dlsym(handle, "mlx_vector_array_new_data");
    if (w_mlx_vector_array_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_new_data\n");
        return -1;
    }
    w_mlx_vector_array_new_value_ptr = dlsym(handle, "mlx_vector_array_new_value");
    if (w_mlx_vector_array_new_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_new_value\n");
        return -1;
    }
    w_mlx_vector_array_set_data_ptr = dlsym(handle, "mlx_vector_array_set_data");
    if (w_mlx_vector_array_set_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_set_data\n");
        return -1;
    }
    w_mlx_vector_array_set_value_ptr = dlsym(handle, "mlx_vector_array_set_value");
    if (w_mlx_vector_array_set_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_set_value\n");
        return -1;
    }
    w_mlx_vector_array_append_data_ptr = dlsym(handle, "mlx_vector_array_append_data");
    if (w_mlx_vector_array_append_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_append_data\n");
        return -1;
    }
    w_mlx_vector_array_append_value_ptr = dlsym(handle, "mlx_vector_array_append_value");
    if (w_mlx_vector_array_append_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_append_value\n");
        return -1;
    }
    w_mlx_vector_array_size_ptr = dlsym(handle, "mlx_vector_array_size");
    if (w_mlx_vector_array_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_size\n");
        return -1;
    }
    w_mlx_vector_array_get_ptr = dlsym(handle, "mlx_vector_array_get");
    if (w_mlx_vector_array_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_array_get\n");
        return -1;
    }
    w_mlx_vector_vector_array_new_ptr = dlsym(handle, "mlx_vector_vector_array_new");
    if (w_mlx_vector_vector_array_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_new\n");
        return -1;
    }
    w_mlx_vector_vector_array_set_ptr = dlsym(handle, "mlx_vector_vector_array_set");
    if (w_mlx_vector_vector_array_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_set\n");
        return -1;
    }
    w_mlx_vector_vector_array_free_ptr = dlsym(handle, "mlx_vector_vector_array_free");
    if (w_mlx_vector_vector_array_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_free\n");
        return -1;
    }
    w_mlx_vector_vector_array_new_data_ptr = dlsym(handle, "mlx_vector_vector_array_new_data");
    if (w_mlx_vector_vector_array_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_new_data\n");
        return -1;
    }
    w_mlx_vector_vector_array_new_value_ptr = dlsym(handle, "mlx_vector_vector_array_new_value");
    if (w_mlx_vector_vector_array_new_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_new_value\n");
        return -1;
    }
    w_mlx_vector_vector_array_set_data_ptr = dlsym(handle, "mlx_vector_vector_array_set_data");
    if (w_mlx_vector_vector_array_set_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_set_data\n");
        return -1;
    }
    w_mlx_vector_vector_array_set_value_ptr = dlsym(handle, "mlx_vector_vector_array_set_value");
    if (w_mlx_vector_vector_array_set_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_set_value\n");
        return -1;
    }
    w_mlx_vector_vector_array_append_data_ptr = dlsym(handle, "mlx_vector_vector_array_append_data");
    if (w_mlx_vector_vector_array_append_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_append_data\n");
        return -1;
    }
    w_mlx_vector_vector_array_append_value_ptr = dlsym(handle, "mlx_vector_vector_array_append_value");
    if (w_mlx_vector_vector_array_append_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_append_value\n");
        return -1;
    }
    w_mlx_vector_vector_array_size_ptr = dlsym(handle, "mlx_vector_vector_array_size");
    if (w_mlx_vector_vector_array_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_size\n");
        return -1;
    }
    w_mlx_vector_vector_array_get_ptr = dlsym(handle, "mlx_vector_vector_array_get");
    if (w_mlx_vector_vector_array_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_vector_array_get\n");
        return -1;
    }
    w_mlx_vector_int_new_ptr = dlsym(handle, "mlx_vector_int_new");
    if (w_mlx_vector_int_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_new\n");
        return -1;
    }
    w_mlx_vector_int_set_ptr = dlsym(handle, "mlx_vector_int_set");
    if (w_mlx_vector_int_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_set\n");
        return -1;
    }
    w_mlx_vector_int_free_ptr = dlsym(handle, "mlx_vector_int_free");
    if (w_mlx_vector_int_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_free\n");
        return -1;
    }
    w_mlx_vector_int_new_data_ptr = dlsym(handle, "mlx_vector_int_new_data");
    if (w_mlx_vector_int_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_new_data\n");
        return -1;
    }
    w_mlx_vector_int_new_value_ptr = dlsym(handle, "mlx_vector_int_new_value");
    if (w_mlx_vector_int_new_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_new_value\n");
        return -1;
    }
    w_mlx_vector_int_set_data_ptr = dlsym(handle, "mlx_vector_int_set_data");
    if (w_mlx_vector_int_set_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_set_data\n");
        return -1;
    }
    w_mlx_vector_int_set_value_ptr = dlsym(handle, "mlx_vector_int_set_value");
    if (w_mlx_vector_int_set_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_set_value\n");
        return -1;
    }
    w_mlx_vector_int_append_data_ptr = dlsym(handle, "mlx_vector_int_append_data");
    if (w_mlx_vector_int_append_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_append_data\n");
        return -1;
    }
    w_mlx_vector_int_append_value_ptr = dlsym(handle, "mlx_vector_int_append_value");
    if (w_mlx_vector_int_append_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_append_value\n");
        return -1;
    }
    w_mlx_vector_int_size_ptr = dlsym(handle, "mlx_vector_int_size");
    if (w_mlx_vector_int_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_size\n");
        return -1;
    }
    w_mlx_vector_int_get_ptr = dlsym(handle, "mlx_vector_int_get");
    if (w_mlx_vector_int_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_int_get\n");
        return -1;
    }
    w_mlx_vector_string_new_ptr = dlsym(handle, "mlx_vector_string_new");
    if (w_mlx_vector_string_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_new\n");
        return -1;
    }
    w_mlx_vector_string_set_ptr = dlsym(handle, "mlx_vector_string_set");
    if (w_mlx_vector_string_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_set\n");
        return -1;
    }
    w_mlx_vector_string_free_ptr = dlsym(handle, "mlx_vector_string_free");
    if (w_mlx_vector_string_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_free\n");
        return -1;
    }
    w_mlx_vector_string_new_data_ptr = dlsym(handle, "mlx_vector_string_new_data");
    if (w_mlx_vector_string_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_new_data\n");
        return -1;
    }
    w_mlx_vector_string_new_value_ptr = dlsym(handle, "mlx_vector_string_new_value");
    if (w_mlx_vector_string_new_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_new_value\n");
        return -1;
    }
    w_mlx_vector_string_set_data_ptr = dlsym(handle, "mlx_vector_string_set_data");
    if (w_mlx_vector_string_set_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_set_data\n");
        return -1;
    }
    w_mlx_vector_string_set_value_ptr = dlsym(handle, "mlx_vector_string_set_value");
    if (w_mlx_vector_string_set_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_set_value\n");
        return -1;
    }
    w_mlx_vector_string_append_data_ptr = dlsym(handle, "mlx_vector_string_append_data");
    if (w_mlx_vector_string_append_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_append_data\n");
        return -1;
    }
    w_mlx_vector_string_append_value_ptr = dlsym(handle, "mlx_vector_string_append_value");
    if (w_mlx_vector_string_append_value_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_append_value\n");
        return -1;
    }
    w_mlx_vector_string_size_ptr = dlsym(handle, "mlx_vector_string_size");
    if (w_mlx_vector_string_size_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_size\n");
        return -1;
    }
    w_mlx_vector_string_get_ptr = dlsym(handle, "mlx_vector_string_get");
    if (w_mlx_vector_string_get_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vector_string_get\n");
        return -1;
    }
    w_mlx_async_eval_ptr = dlsym(handle, "mlx_async_eval");
    if (w_mlx_async_eval_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_async_eval\n");
        return -1;
    }
    w_mlx_checkpoint_ptr = dlsym(handle, "mlx_checkpoint");
    if (w_mlx_checkpoint_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_checkpoint\n");
        return -1;
    }
    w_mlx_custom_function_ptr = dlsym(handle, "mlx_custom_function");
    if (w_mlx_custom_function_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_custom_function\n");
        return -1;
    }
    w_mlx_custom_vjp_ptr = dlsym(handle, "mlx_custom_vjp");
    if (w_mlx_custom_vjp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_custom_vjp\n");
        return -1;
    }
    w_mlx_eval_ptr = dlsym(handle, "mlx_eval");
    if (w_mlx_eval_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_eval\n");
        return -1;
    }
    w_mlx_jvp_ptr = dlsym(handle, "mlx_jvp");
    if (w_mlx_jvp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_jvp\n");
        return -1;
    }
    w_mlx_value_and_grad_ptr = dlsym(handle, "mlx_value_and_grad");
    if (w_mlx_value_and_grad_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_value_and_grad\n");
        return -1;
    }
    w_mlx_vjp_ptr = dlsym(handle, "mlx_vjp");
    if (w_mlx_vjp_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_vjp\n");
        return -1;
    }
    w_mlx_random_bernoulli_ptr = dlsym(handle, "mlx_random_bernoulli");
    if (w_mlx_random_bernoulli_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_bernoulli\n");
        return -1;
    }
    w_mlx_random_bits_ptr = dlsym(handle, "mlx_random_bits");
    if (w_mlx_random_bits_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_bits\n");
        return -1;
    }
    w_mlx_random_categorical_shape_ptr = dlsym(handle, "mlx_random_categorical_shape");
    if (w_mlx_random_categorical_shape_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_categorical_shape\n");
        return -1;
    }
    w_mlx_random_categorical_num_samples_ptr = dlsym(handle, "mlx_random_categorical_num_samples");
    if (w_mlx_random_categorical_num_samples_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_categorical_num_samples\n");
        return -1;
    }
    w_mlx_random_categorical_ptr = dlsym(handle, "mlx_random_categorical");
    if (w_mlx_random_categorical_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_categorical\n");
        return -1;
    }
    w_mlx_random_gumbel_ptr = dlsym(handle, "mlx_random_gumbel");
    if (w_mlx_random_gumbel_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_gumbel\n");
        return -1;
    }
    w_mlx_random_key_ptr = dlsym(handle, "mlx_random_key");
    if (w_mlx_random_key_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_key\n");
        return -1;
    }
    w_mlx_random_laplace_ptr = dlsym(handle, "mlx_random_laplace");
    if (w_mlx_random_laplace_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_laplace\n");
        return -1;
    }
    w_mlx_random_multivariate_normal_ptr = dlsym(handle, "mlx_random_multivariate_normal");
    if (w_mlx_random_multivariate_normal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_multivariate_normal\n");
        return -1;
    }
    w_mlx_random_normal_broadcast_ptr = dlsym(handle, "mlx_random_normal_broadcast");
    if (w_mlx_random_normal_broadcast_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_normal_broadcast\n");
        return -1;
    }
    w_mlx_random_normal_ptr = dlsym(handle, "mlx_random_normal");
    if (w_mlx_random_normal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_normal\n");
        return -1;
    }
    w_mlx_random_permutation_ptr = dlsym(handle, "mlx_random_permutation");
    if (w_mlx_random_permutation_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_permutation\n");
        return -1;
    }
    w_mlx_random_permutation_arange_ptr = dlsym(handle, "mlx_random_permutation_arange");
    if (w_mlx_random_permutation_arange_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_permutation_arange\n");
        return -1;
    }
    w_mlx_random_randint_ptr = dlsym(handle, "mlx_random_randint");
    if (w_mlx_random_randint_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_randint\n");
        return -1;
    }
    w_mlx_random_seed_ptr = dlsym(handle, "mlx_random_seed");
    if (w_mlx_random_seed_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_seed\n");
        return -1;
    }
    w_mlx_random_split_num_ptr = dlsym(handle, "mlx_random_split_num");
    if (w_mlx_random_split_num_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_split_num\n");
        return -1;
    }
    w_mlx_random_split_ptr = dlsym(handle, "mlx_random_split");
    if (w_mlx_random_split_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_split\n");
        return -1;
    }
    w_mlx_random_truncated_normal_ptr = dlsym(handle, "mlx_random_truncated_normal");
    if (w_mlx_random_truncated_normal_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_truncated_normal\n");
        return -1;
    }
    w_mlx_random_uniform_ptr = dlsym(handle, "mlx_random_uniform");
    if (w_mlx_random_uniform_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_random_uniform\n");
        return -1;
    }
    w_mlx_string_new_ptr = dlsym(handle, "mlx_string_new");
    if (w_mlx_string_new_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_string_new\n");
        return -1;
    }
    w_mlx_string_new_data_ptr = dlsym(handle, "mlx_string_new_data");
    if (w_mlx_string_new_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_string_new_data\n");
        return -1;
    }
    w_mlx_string_set_ptr = dlsym(handle, "mlx_string_set");
    if (w_mlx_string_set_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_string_set\n");
        return -1;
    }
    w_mlx_string_data_ptr = dlsym(handle, "mlx_string_data");
    if (w_mlx_string_data_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_string_data\n");
        return -1;
    }
    w_mlx_string_free_ptr = dlsym(handle, "mlx_string_free");
    if (w_mlx_string_free_ptr == NULL) {
        fprintf(stderr, "MLX: Failed to load symbol: mlx_string_free\n");
        return -1;
    }
    return 0;
}
